<!DOCTYPE html>

<html :class="{'dark': darkMode === 'dark' || (darkMode === 'system' &amp;&amp; window.matchMedia('(prefers-color-scheme: dark)').matches)}" class="scroll-smooth" data-content_root="../" lang="en" x-data="{ darkMode: localStorage.getItem('darkMode') || localStorage.setItem('darkMode', 'system'), activeSection: '' }" x-init="$watch('darkMode', val =&gt; localStorage.setItem('darkMode', val))">
<head>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta charset="utf-8"/>
<meta content="white" media="(prefers-color-scheme: light)" name="theme-color"/>
<meta content="black" media="(prefers-color-scheme: dark)" name="theme-color"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>stable_worldmodel package | stable-worldmodel</title>
<meta content="stable_worldmodel package | stable-worldmodel" property="og:title"/>
<meta content="stable_worldmodel package | stable-worldmodel" name="twitter:title"/>
<link href="../_static/pygments.css?v=91c1d931" rel="stylesheet" type="text/css"/>
<link href="../_static/theme.css?v=42baaae4" rel="stylesheet" type="text/css"/>
<link href="../_static/sphinx-design.min.css?v=95c83b7e" rel="stylesheet" type="text/css"/>
<link href="../_static/css/custom.css?v=879ef6c1" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css" rel="stylesheet" type="text/css"/>
<link href="../_static/awesome-sphinx-design.css?v=15e0fffa" rel="stylesheet" type="text/css"/>
<link href="../_static/favicon.ico" rel="icon"/>
<link href="../search/" rel="search" title="Search"/>
<link href="../genindex/" rel="index" title="Index"/>
<script>
    <!-- Prevent Flash of wrong theme -->
      const userPreference = localStorage.getItem('darkMode');
      let mode;
      if (userPreference === 'dark' || window.matchMedia('(prefers-color-scheme: dark)').matches) {
        mode = 'dark';
        document.documentElement.classList.add('dark');
      } else {
        mode = 'light';
      }
      if (!userPreference) {localStorage.setItem('darkMode', mode)}
    </script>
</head>
<body :class="{ 'overflow-hidden': showSidebar }" @scroll.window="showScrollTop = pageYOffset &gt; 100" class="min-h-screen font-sans antialiased bg-background text-foreground" x-data="{ showSidebar: false, showScrollTop: false }">
<div @click.self="showSidebar = false" class="fixed inset-0 z-50 overflow-hidden bg-background/80 backdrop-blur-sm md:hidden" x-cloak="" x-show="showSidebar"></div><div class="relative flex flex-col min-h-screen" id="page"><a class="absolute top-0 left-0 z-[100] block bg-background p-4 text-xl transition -translate-x-full opacity-0 focus:translate-x-0 focus:opacity-100" href="#content">
      Skip to content
    </a><header class="sticky top-0 z-40 w-full border-b shadow-sm border-border supports-backdrop-blur:bg-background/60 bg-background/95 backdrop-blur"><div class="container flex items-center h-14">
<div class="hidden mr-4 md:flex">
<a class="flex items-center mr-6" href="../"><span class="hidden font-bold sm:inline-block text-clip whitespace-nowrap">stable-worldmodel</span>
</a></div><button @click="showSidebar = true" class="inline-flex items-center justify-center h-10 px-0 py-2 mr-2 text-base font-medium transition-colors rounded-md hover:text-accent-foreground hover:bg-transparent md:hidden" type="button">
<svg aria-hidden="true" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M152.587 825.087q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440Zm0-203.587q-19.152 0-32.326-13.174T107.087 576q0-19.152 13.174-32.326t32.326-13.174h320q19.152 0 32.326 13.174T518.087 576q0 19.152-13.174 32.326T472.587 621.5h-320Zm0-203.587q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440ZM708.913 576l112.174 112.174q12.674 12.674 12.674 31.826t-12.674 31.826Q808.413 764.5 789.261 764.5t-31.826-12.674l-144-144Q600 594.391 600 576t13.435-31.826l144-144q12.674-12.674 31.826-12.674t31.826 12.674q12.674 12.674 12.674 31.826t-12.674 31.826L708.913 576Z"></path>
</svg>
<span class="sr-only">Toggle navigation menu</span>
</button>
<div class="flex items-center justify-between flex-1 space-x-2 sm:space-x-4 md:justify-end">
<div class="flex-1 w-full md:w-auto md:flex-none"><form @keydown.k.window.meta="$refs.search.focus()" action="../search/" class="relative flex items-center group" id="searchbox" method="get">
<input aria-label="Search the docs" class="inline-flex items-center font-medium transition-colors bg-transparent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background border border-input hover:bg-accent focus:bg-accent hover:text-accent-foreground focus:text-accent-foreground hover:placeholder-accent-foreground py-2 px-4 relative h-9 w-full justify-start rounded-[0.5rem] text-sm text-muted-foreground sm:pr-12 md:w-40 lg:w-64" id="search-input" name="q" placeholder="Search ..." type="search" x-ref="search"/>
<kbd class="pointer-events-none absolute right-1.5 top-2 hidden h-5 select-none text-muted-foreground items-center gap-1 rounded border border-border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex group-hover:bg-accent group-hover:text-accent-foreground">
<span class="text-xs">âŒ˜</span>
    K
  </kbd>
</form>
</div>
<nav class="flex items-center space-x-1">
<a href="https://github.com/rbalestr-lab/stable-worldmodel" rel="noopener nofollow" title="Visit repository on GitHub">
<div class="inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md disabled:opacity-50 disabled:pointer-events-none hover:bg-accent hover:text-accent-foreground h-9 w-9">
<svg fill="currentColor" height="26px" style="margin-top:-2px;display:inline" viewbox="0 0 45 44" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M22.477.927C10.485.927.76 10.65.76 22.647c0 9.596 6.223 17.736 14.853 20.608 1.087.2 1.483-.47 1.483-1.047 0-.516-.019-1.881-.03-3.693-6.04 1.312-7.315-2.912-7.315-2.912-.988-2.51-2.412-3.178-2.412-3.178-1.972-1.346.149-1.32.149-1.32 2.18.154 3.327 2.24 3.327 2.24 1.937 3.318 5.084 2.36 6.321 1.803.197-1.403.759-2.36 1.379-2.903-4.823-.548-9.894-2.412-9.894-10.734 0-2.37.847-4.31 2.236-5.828-.224-.55-.969-2.759.214-5.748 0 0 1.822-.584 5.972 2.226 1.732-.482 3.59-.722 5.437-.732 1.845.01 3.703.25 5.437.732 4.147-2.81 5.967-2.226 5.967-2.226 1.185 2.99.44 5.198.217 5.748 1.392 1.517 2.232 3.457 2.232 5.828 0 8.344-5.078 10.18-9.916 10.717.779.67 1.474 1.996 1.474 4.021 0 2.904-.027 5.247-.027 5.96 0 .58.392 1.256 1.493 1.044C37.981 40.375 44.2 32.24 44.2 22.647c0-11.996-9.726-21.72-21.722-21.72" fill="currentColor" fill-rule="evenodd"></path></svg>
</div>
</a>
<button @click="darkMode = darkMode === 'light' ? 'dark' : 'light'" aria-label="Color theme switcher" class="relative inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md hover:bg-accent hover:text-accent-foreground h-9 w-9" type="button">
<svg class="absolute transition-all scale-100 rotate-0 dark:-rotate-90 dark:scale-0" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 685q45.456 0 77.228-31.772Q589 621.456 589 576q0-45.456-31.772-77.228Q525.456 467 480 467q-45.456 0-77.228 31.772Q371 530.544 371 576q0 45.456 31.772 77.228Q434.544 685 480 685Zm0 91q-83 0-141.5-58.5T280 576q0-83 58.5-141.5T480 376q83 0 141.5 58.5T680 576q0 83-58.5 141.5T480 776ZM80 621.5q-19.152 0-32.326-13.174T34.5 576q0-19.152 13.174-32.326T80 530.5h80q19.152 0 32.326 13.174T205.5 576q0 19.152-13.174 32.326T160 621.5H80Zm720 0q-19.152 0-32.326-13.174T754.5 576q0-19.152 13.174-32.326T800 530.5h80q19.152 0 32.326 13.174T925.5 576q0 19.152-13.174 32.326T880 621.5h-80Zm-320-320q-19.152 0-32.326-13.174T434.5 256v-80q0-19.152 13.174-32.326T480 130.5q19.152 0 32.326 13.174T525.5 176v80q0 19.152-13.174 32.326T480 301.5Zm0 720q-19.152 0-32.326-13.17Q434.5 995.152 434.5 976v-80q0-19.152 13.174-32.326T480 850.5q19.152 0 32.326 13.174T525.5 896v80q0 19.152-13.174 32.33-13.174 13.17-32.326 13.17ZM222.174 382.065l-43-42Q165.5 327.391 166 308.239t13.174-33.065q13.435-13.674 32.587-13.674t32.065 13.674l42.239 43q12.674 13.435 12.555 31.706-.12 18.272-12.555 31.946-12.674 13.674-31.445 13.413-18.772-.261-32.446-13.174Zm494 494.761-42.239-43q-12.674-13.435-12.674-32.087t12.674-31.565Q686.609 756.5 705.38 757q18.772.5 32.446 13.174l43 41.761Q794.5 824.609 794 843.761t-13.174 33.065Q767.391 890.5 748.239 890.5t-32.065-13.674Zm-42-494.761Q660.5 369.391 661 350.62q.5-18.772 13.174-32.446l41.761-43Q728.609 261.5 747.761 262t33.065 13.174q13.674 13.435 13.674 32.587t-13.674 32.065l-43 42.239q-13.435 12.674-31.706 12.555-18.272-.12-31.946-12.555Zm-495 494.761Q165.5 863.391 165.5 844.239t13.674-32.065l43-42.239q13.435-12.674 32.087-12.674t31.565 12.674Q299.5 782.609 299 801.38q-.5 18.772-13.174 32.446l-41.761 43Q231.391 890.5 212.239 890t-33.065-13.174ZM480 576Z"></path>
</svg>
<svg class="absolute transition-all scale-0 rotate-90 dark:rotate-0 dark:scale-100" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 936q-151 0-255.5-104.5T120 576q0-138 90-239.5T440 218q25-3 39 18t-1 44q-17 26-25.5 55t-8.5 61q0 90 63 153t153 63q31 0 61.5-9t54.5-25q21-14 43-1.5t19 39.5q-14 138-117.5 229T480 936Zm0-80q88 0 158-48.5T740 681q-20 5-40 8t-40 3q-123 0-209.5-86.5T364 396q0-20 3-40t8-40q-78 32-126.5 102T200 576q0 116 82 198t198 82Zm-10-270Z"></path>
</svg>
</button>
</nav>
</div>
</div>
</header>
<div class="flex-1"><div class="container flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[240px_minmax(0,1fr)] lg:gap-10"><aside :aria-hidden="!showSidebar" :class="{ 'translate-x-0': showSidebar }" class="fixed inset-y-0 left-0 md:top-14 z-50 md:z-30 bg-background md:bg-transparent transition-all duration-100 -translate-x-full md:translate-x-0 ml-0 p-6 md:p-0 md:-ml-2 md:h-[calc(100vh-3.5rem)] w-5/6 md:w-full shrink-0 overflow-y-auto border-r border-border md:sticky" id="left-sidebar">
<a class="!justify-start text-sm md:!hidden bg-background" href="../"><span class="font-bold text-clip whitespace-nowrap">stable-worldmodel</span>
</a>
<div class="relative overflow-hidden md:overflow-auto my-4 md:my-0 h-[calc(100vh-8rem)] md:h-auto">
<div class="overflow-y-auto h-full w-full relative pr-6"><nav class="table w-full min-w-full my-6 lg:my-8">
<p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/quickstart/">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/showcase/">Showcase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/contributing/">Contributing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/data/">StepsDataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/world/">World</a></li>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../api/policy/">Policy<button @click.prevent.stop="expanded = !expanded" type="button"><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.policy.PlanConfig/">PlanConfig</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.policy.BasePolicy/">BasePolicy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.policy.RandomPolicy/">RandomPolicy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.policy.ExpertPolicy/">ExpertPolicy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.policy.WorldModelPolicy/">WorldModelPolicy</a></li>
</ul>
</li>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../api/solver/">Solver<button @click.prevent.stop="expanded = !expanded" type="button"><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.solver.GDSolver/">GDSolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.solver.CEMSolver/">CEMSolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.solver.MPPISolver/">MPPISolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.solver.NevergradSolver/">NevergradSolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.solver.RandomSolver/">RandomSolver</a></li>
</ul>
</li>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../api/spaces/">Space<button @click.prevent.stop="expanded = !expanded" type="button"><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.spaces.Discrete/">Discrete</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.spaces.MultiDiscrete/">MultiDiscrete</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.spaces.Box/">Box</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.spaces.RGBBox/">RGBBox</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.spaces.Dict/">Dict</a></li>
</ul>
</li>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../api/wrappers/">Wrappers<button @click.prevent.stop="expanded = !expanded" type="button"><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.wrappers.EnsureInfoKeysWrapper/">EnsureInfoKeysWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.wrappers.EnsureImageShape/">EnsureImageShape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.wrappers.EnsureGoalInfoWrapper/">EnsureGoalInfoWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.wrappers.EverythingToInfoWrapper/">EverythingToInfoWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.wrappers.AddPixelsWrapper/">AddPixelsWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.wrappers.ResizeGoalWrapper/">ResizeGoalWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.wrappers.MegaWrapper/">MegaWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/stable_worldmodel.wrappers.VariationWrapper/">VariationWrapper</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dinowm/">Reproducing DINO-WM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/new-world/">Adding New World</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Worlds</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../world/pusht/">PushT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../world/simple-pointmaze/">Simple Point-Maze</a></li>
<li class="toctree-l1"><a class="reference internal" href="../world/two_room/">Two Rooms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../world/voidrun/">Void Run</a></li>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../world/OGBench/">OGBench<button @click.prevent.stop="expanded = !expanded" type="button"><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="../world/OGBench/cube/">Cube</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
<button @click="showSidebar = false" class="absolute md:hidden right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100" type="button">
<svg class="h-4 w-4" fill="currentColor" height="24" stroke="none" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 632 284 828q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536 576l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480 632Z"></path>
</svg>
</button>
</aside>
<main class="relative py-6 lg:gap-10 lg:py-8 xl:grid xl:grid-cols-[1fr_300px]">
<div class="w-full min-w-0 mx-auto">
<nav aria-label="breadcrumbs" class="flex items-center mb-4 space-x-1 text-sm text-muted-foreground">
<a class="overflow-hidden text-ellipsis whitespace-nowrap hover:text-foreground" href="../">
<span class="hidden md:inline">stable-worldmodel</span>
<svg aria-label="Home" class="md:hidden" fill="currentColor" height="18" stroke="none" viewbox="0 96 960 960" width="18" xmlns="http://www.w3.org/2000/svg">
<path d="M240 856h120V616h240v240h120V496L480 316 240 496v360Zm-80 80V456l320-240 320 240v480H520V696h-80v240H160Zm320-350Z"></path>
</svg>
</a>
<div class="mr-1">/</div><span aria-current="page" class="font-medium text-foreground overflow-hidden text-ellipsis whitespace-nowrap">stable_worldmodel package</span>
</nav>
<div id="content" role="main">
<section id="stable-worldmodel-package">
<h1>stable_worldmodel package<a class="headerlink" href="#stable-worldmodel-package" title="Link to this heading"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#subpackages'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../stable_worldmodel.envs/">stable_worldmodel.envs package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.envs/#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.envs/#module-stable_worldmodel.envs.image_positioning">stable_worldmodel.envs.image_positioning module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.image_positioning.ImagePositioning"><code class="docutils literal notranslate"><span class="pre">ImagePositioning</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.image_positioning.ImagePositioning.close"><code class="docutils literal notranslate"><span class="pre">ImagePositioning.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.image_positioning.ImagePositioning.metadata"><code class="docutils literal notranslate"><span class="pre">ImagePositioning.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.image_positioning.ImagePositioning.render"><code class="docutils literal notranslate"><span class="pre">ImagePositioning.render()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.image_positioning.ImagePositioning.reset"><code class="docutils literal notranslate"><span class="pre">ImagePositioning.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.image_positioning.ImagePositioning.step"><code class="docutils literal notranslate"><span class="pre">ImagePositioning.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.envs/#module-stable_worldmodel.envs.ogbench_cube">stable_worldmodel.envs.ogbench_cube module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv"><code class="docutils literal notranslate"><span class="pre">CubeEnv</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.__init__"><code class="docutils literal notranslate"><span class="pre">CubeEnv.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.add_object_info"><code class="docutils literal notranslate"><span class="pre">CubeEnv.add_object_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.add_objects"><code class="docutils literal notranslate"><span class="pre">CubeEnv.add_objects()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.compute_observation"><code class="docutils literal notranslate"><span class="pre">CubeEnv.compute_observation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.compute_oracle_observation"><code class="docutils literal notranslate"><span class="pre">CubeEnv.compute_oracle_observation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.compute_reward"><code class="docutils literal notranslate"><span class="pre">CubeEnv.compute_reward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.get_reset_info"><code class="docutils literal notranslate"><span class="pre">CubeEnv.get_reset_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.get_step_info"><code class="docutils literal notranslate"><span class="pre">CubeEnv.get_step_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.initialize_episode"><code class="docutils literal notranslate"><span class="pre">CubeEnv.initialize_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.modify_mjcf_model"><code class="docutils literal notranslate"><span class="pre">CubeEnv.modify_mjcf_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.post_compilation_objects"><code class="docutils literal notranslate"><span class="pre">CubeEnv.post_compilation_objects()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.post_step"><code class="docutils literal notranslate"><span class="pre">CubeEnv.post_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.render"><code class="docutils literal notranslate"><span class="pre">CubeEnv.render()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.render_multiview"><code class="docutils literal notranslate"><span class="pre">CubeEnv.render_multiview()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.reset"><code class="docutils literal notranslate"><span class="pre">CubeEnv.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.set_new_target"><code class="docutils literal notranslate"><span class="pre">CubeEnv.set_new_target()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_cube.CubeEnv.set_tasks"><code class="docutils literal notranslate"><span class="pre">CubeEnv.set_tasks()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.envs/#module-stable_worldmodel.envs.ogbench_scene">stable_worldmodel.envs.ogbench_scene module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv"><code class="docutils literal notranslate"><span class="pre">SceneEnv</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.__init__"><code class="docutils literal notranslate"><span class="pre">SceneEnv.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.add_object_info"><code class="docutils literal notranslate"><span class="pre">SceneEnv.add_object_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.add_objects"><code class="docutils literal notranslate"><span class="pre">SceneEnv.add_objects()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.compute_observation"><code class="docutils literal notranslate"><span class="pre">SceneEnv.compute_observation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.compute_oracle_observation"><code class="docutils literal notranslate"><span class="pre">SceneEnv.compute_oracle_observation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.compute_reward"><code class="docutils literal notranslate"><span class="pre">SceneEnv.compute_reward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.get_reset_info"><code class="docutils literal notranslate"><span class="pre">SceneEnv.get_reset_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.get_step_info"><code class="docutils literal notranslate"><span class="pre">SceneEnv.get_step_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.initialize_episode"><code class="docutils literal notranslate"><span class="pre">SceneEnv.initialize_episode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.modify_mjcf_model"><code class="docutils literal notranslate"><span class="pre">SceneEnv.modify_mjcf_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.post_compilation_objects"><code class="docutils literal notranslate"><span class="pre">SceneEnv.post_compilation_objects()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.post_step"><code class="docutils literal notranslate"><span class="pre">SceneEnv.post_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.pre_step"><code class="docutils literal notranslate"><span class="pre">SceneEnv.pre_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.render"><code class="docutils literal notranslate"><span class="pre">SceneEnv.render()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.reset"><code class="docutils literal notranslate"><span class="pre">SceneEnv.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.set_new_target"><code class="docutils literal notranslate"><span class="pre">SceneEnv.set_new_target()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.set_state"><code class="docutils literal notranslate"><span class="pre">SceneEnv.set_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.ogbench_scene.SceneEnv.set_tasks"><code class="docutils literal notranslate"><span class="pre">SceneEnv.set_tasks()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.envs/#module-stable_worldmodel.envs.pusht">stable_worldmodel.envs.pusht module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT"><code class="docutils literal notranslate"><span class="pre">PushT</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.add_I"><code class="docutils literal notranslate"><span class="pre">PushT.add_I()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.add_L"><code class="docutils literal notranslate"><span class="pre">PushT.add_L()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.add_Z"><code class="docutils literal notranslate"><span class="pre">PushT.add_Z()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.add_box"><code class="docutils literal notranslate"><span class="pre">PushT.add_box()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.add_circle"><code class="docutils literal notranslate"><span class="pre">PushT.add_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.add_plus"><code class="docutils literal notranslate"><span class="pre">PushT.add_plus()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.add_shape"><code class="docutils literal notranslate"><span class="pre">PushT.add_shape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.add_small_tee"><code class="docutils literal notranslate"><span class="pre">PushT.add_small_tee()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.add_square"><code class="docutils literal notranslate"><span class="pre">PushT.add_square()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.add_tee"><code class="docutils literal notranslate"><span class="pre">PushT.add_tee()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.close"><code class="docutils literal notranslate"><span class="pre">PushT.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.eval_state"><code class="docutils literal notranslate"><span class="pre">PushT.eval_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.fix_action_sample"><code class="docutils literal notranslate"><span class="pre">PushT.fix_action_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.metadata"><code class="docutils literal notranslate"><span class="pre">PushT.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.render"><code class="docutils literal notranslate"><span class="pre">PushT.render()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.reset"><code class="docutils literal notranslate"><span class="pre">PushT.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.reward_range"><code class="docutils literal notranslate"><span class="pre">PushT.reward_range</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.pusht.PushT.step"><code class="docutils literal notranslate"><span class="pre">PushT.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.envs/#module-stable_worldmodel.envs.simple_point_maze">stable_worldmodel.envs.simple_point_maze module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.simple_point_maze.SimplePointMazeEnv"><code class="docutils literal notranslate"><span class="pre">SimplePointMazeEnv</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.simple_point_maze.SimplePointMazeEnv.close"><code class="docutils literal notranslate"><span class="pre">SimplePointMazeEnv.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.simple_point_maze.SimplePointMazeEnv.metadata"><code class="docutils literal notranslate"><span class="pre">SimplePointMazeEnv.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.simple_point_maze.SimplePointMazeEnv.render"><code class="docutils literal notranslate"><span class="pre">SimplePointMazeEnv.render()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.simple_point_maze.SimplePointMazeEnv.reset"><code class="docutils literal notranslate"><span class="pre">SimplePointMazeEnv.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.simple_point_maze.SimplePointMazeEnv.step"><code class="docutils literal notranslate"><span class="pre">SimplePointMazeEnv.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.envs/#module-stable_worldmodel.envs.two_room">stable_worldmodel.envs.two_room module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.two_room.TwoRoomEnv"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.two_room.TwoRoomEnv.add_circle"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.add_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.two_room.TwoRoomEnv.check_collide"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.check_collide()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.two_room.TwoRoomEnv.check_one_door_fit"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.check_one_door_fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.two_room.TwoRoomEnv.check_other_room"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.check_other_room()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.two_room.TwoRoomEnv.close"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.two_room.TwoRoomEnv.metadata"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.two_room.TwoRoomEnv.render"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.render()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.two_room.TwoRoomEnv.reset"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.two_room.TwoRoomEnv.seed"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.seed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.two_room.TwoRoomEnv.step"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.envs/#module-stable_worldmodel.envs.utils">stable_worldmodel.envs.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.utils.DrawOptions"><code class="docutils literal notranslate"><span class="pre">DrawOptions</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.utils.DrawOptions.__init__"><code class="docutils literal notranslate"><span class="pre">DrawOptions.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.utils.DrawOptions.draw_circle"><code class="docutils literal notranslate"><span class="pre">DrawOptions.draw_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.utils.DrawOptions.draw_dot"><code class="docutils literal notranslate"><span class="pre">DrawOptions.draw_dot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.utils.DrawOptions.draw_fat_segment"><code class="docutils literal notranslate"><span class="pre">DrawOptions.draw_fat_segment()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.utils.DrawOptions.draw_polygon"><code class="docutils literal notranslate"><span class="pre">DrawOptions.draw_polygon()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.utils.DrawOptions.draw_segment"><code class="docutils literal notranslate"><span class="pre">DrawOptions.draw_segment()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.utils.from_pygame"><code class="docutils literal notranslate"><span class="pre">from_pygame()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.utils.get_mouse_pos"><code class="docutils literal notranslate"><span class="pre">get_mouse_pos()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.utils.light_color"><code class="docutils literal notranslate"><span class="pre">light_color()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.utils.perturb_camera_angle"><code class="docutils literal notranslate"><span class="pre">perturb_camera_angle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.utils.pymunk_to_shapely"><code class="docutils literal notranslate"><span class="pre">pymunk_to_shapely()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.utils.to_pygame"><code class="docutils literal notranslate"><span class="pre">to_pygame()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.envs/#module-stable_worldmodel.envs.voidrun">stable_worldmodel.envs.voidrun module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.Action"><code class="docutils literal notranslate"><span class="pre">Action</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.Action.DOWN"><code class="docutils literal notranslate"><span class="pre">Action.DOWN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.Action.LEFT"><code class="docutils literal notranslate"><span class="pre">Action.LEFT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.Action.RIGHT"><code class="docutils literal notranslate"><span class="pre">Action.RIGHT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.Action.UP"><code class="docutils literal notranslate"><span class="pre">Action.UP</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.VoidRunEnv"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.VoidRunEnv.check_location"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.check_location()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.VoidRunEnv.check_termination"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.check_termination()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.VoidRunEnv.close"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.VoidRunEnv.generate_board"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.generate_board()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.VoidRunEnv.generate_goal"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.generate_goal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.VoidRunEnv.metadata"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.VoidRunEnv.render"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.render()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.VoidRunEnv.render_board"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.render_board()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.VoidRunEnv.reset"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.VoidRunEnv.set_state"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.set_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.voidrun.VoidRunEnv.step"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.envs/#module-stable_worldmodel.envs">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.envs/#stable_worldmodel.envs.register"><code class="docutils literal notranslate"><span class="pre">register()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stable_worldmodel.solver/">stable_worldmodel.solver package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.solver/#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.solver/#module-stable_worldmodel.solver.cem">stable_worldmodel.solver.cem module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.cem.CEMSolver"><code class="docutils literal notranslate"><span class="pre">CEMSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.cem.CEMSolver.action_dim"><code class="docutils literal notranslate"><span class="pre">CEMSolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.cem.CEMSolver.configure"><code class="docutils literal notranslate"><span class="pre">CEMSolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.cem.CEMSolver.horizon"><code class="docutils literal notranslate"><span class="pre">CEMSolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.cem.CEMSolver.init_action_distrib"><code class="docutils literal notranslate"><span class="pre">CEMSolver.init_action_distrib()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.cem.CEMSolver.n_envs"><code class="docutils literal notranslate"><span class="pre">CEMSolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.cem.CEMSolver.solve"><code class="docutils literal notranslate"><span class="pre">CEMSolver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.solver/#module-stable_worldmodel.solver.gd">stable_worldmodel.solver.gd module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.gd.GDSolver"><code class="docutils literal notranslate"><span class="pre">GDSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.gd.GDSolver.action_dim"><code class="docutils literal notranslate"><span class="pre">GDSolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.gd.GDSolver.configure"><code class="docutils literal notranslate"><span class="pre">GDSolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.gd.GDSolver.horizon"><code class="docutils literal notranslate"><span class="pre">GDSolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.gd.GDSolver.init_action"><code class="docutils literal notranslate"><span class="pre">GDSolver.init_action()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.gd.GDSolver.n_envs"><code class="docutils literal notranslate"><span class="pre">GDSolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.gd.GDSolver.set_seed"><code class="docutils literal notranslate"><span class="pre">GDSolver.set_seed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.gd.GDSolver.solve"><code class="docutils literal notranslate"><span class="pre">GDSolver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.solver/#module-stable_worldmodel.solver.mppi">stable_worldmodel.solver.mppi module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.mppi.MPPISolver"><code class="docutils literal notranslate"><span class="pre">MPPISolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.mppi.MPPISolver.action_dim"><code class="docutils literal notranslate"><span class="pre">MPPISolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.mppi.MPPISolver.compute_trajectory_weights"><code class="docutils literal notranslate"><span class="pre">MPPISolver.compute_trajectory_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.mppi.MPPISolver.configure"><code class="docutils literal notranslate"><span class="pre">MPPISolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.mppi.MPPISolver.horizon"><code class="docutils literal notranslate"><span class="pre">MPPISolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.mppi.MPPISolver.init_action_distrib"><code class="docutils literal notranslate"><span class="pre">MPPISolver.init_action_distrib()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.mppi.MPPISolver.n_envs"><code class="docutils literal notranslate"><span class="pre">MPPISolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.mppi.MPPISolver.solve"><code class="docutils literal notranslate"><span class="pre">MPPISolver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.solver/#module-stable_worldmodel.solver.nevergrad">stable_worldmodel.solver.nevergrad module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.nevergrad.NevergradSolver"><code class="docutils literal notranslate"><span class="pre">NevergradSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.nevergrad.NevergradSolver.action_dim"><code class="docutils literal notranslate"><span class="pre">NevergradSolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.nevergrad.NevergradSolver.configure"><code class="docutils literal notranslate"><span class="pre">NevergradSolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.nevergrad.NevergradSolver.horizon"><code class="docutils literal notranslate"><span class="pre">NevergradSolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.nevergrad.NevergradSolver.n_envs"><code class="docutils literal notranslate"><span class="pre">NevergradSolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.nevergrad.NevergradSolver.solve"><code class="docutils literal notranslate"><span class="pre">NevergradSolver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.solver/#stable-worldmodel-solver-old-mppi-module">stable_worldmodel.solver.old_mppi module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.solver/#module-stable_worldmodel.solver.random">stable_worldmodel.solver.random module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.random.RandomSolver"><code class="docutils literal notranslate"><span class="pre">RandomSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.random.RandomSolver.__init__"><code class="docutils literal notranslate"><span class="pre">RandomSolver.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.random.RandomSolver.action_dim"><code class="docutils literal notranslate"><span class="pre">RandomSolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.random.RandomSolver.configure"><code class="docutils literal notranslate"><span class="pre">RandomSolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.random.RandomSolver.horizon"><code class="docutils literal notranslate"><span class="pre">RandomSolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.random.RandomSolver.n_envs"><code class="docutils literal notranslate"><span class="pre">RandomSolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.random.RandomSolver.solve"><code class="docutils literal notranslate"><span class="pre">RandomSolver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.solver/#module-stable_worldmodel.solver.solver">stable_worldmodel.solver.solver module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.solver.Costable"><code class="docutils literal notranslate"><span class="pre">Costable</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.solver.Costable.get_cost"><code class="docutils literal notranslate"><span class="pre">Costable.get_cost()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.solver.Solver"><code class="docutils literal notranslate"><span class="pre">Solver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.solver.Solver.action_dim"><code class="docutils literal notranslate"><span class="pre">Solver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.solver.Solver.configure"><code class="docutils literal notranslate"><span class="pre">Solver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.solver.Solver.horizon"><code class="docutils literal notranslate"><span class="pre">Solver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.solver.Solver.n_envs"><code class="docutils literal notranslate"><span class="pre">Solver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.solver.Solver.solve"><code class="docutils literal notranslate"><span class="pre">Solver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.solver/#module-stable_worldmodel.solver">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.CEMSolver"><code class="docutils literal notranslate"><span class="pre">CEMSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.CEMSolver.action_dim"><code class="docutils literal notranslate"><span class="pre">CEMSolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.CEMSolver.configure"><code class="docutils literal notranslate"><span class="pre">CEMSolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.CEMSolver.horizon"><code class="docutils literal notranslate"><span class="pre">CEMSolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.CEMSolver.init_action_distrib"><code class="docutils literal notranslate"><span class="pre">CEMSolver.init_action_distrib()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.CEMSolver.n_envs"><code class="docutils literal notranslate"><span class="pre">CEMSolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.CEMSolver.solve"><code class="docutils literal notranslate"><span class="pre">CEMSolver.solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.GDSolver"><code class="docutils literal notranslate"><span class="pre">GDSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.GDSolver.action_dim"><code class="docutils literal notranslate"><span class="pre">GDSolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.GDSolver.configure"><code class="docutils literal notranslate"><span class="pre">GDSolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.GDSolver.horizon"><code class="docutils literal notranslate"><span class="pre">GDSolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.GDSolver.init_action"><code class="docutils literal notranslate"><span class="pre">GDSolver.init_action()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.GDSolver.n_envs"><code class="docutils literal notranslate"><span class="pre">GDSolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.GDSolver.set_seed"><code class="docutils literal notranslate"><span class="pre">GDSolver.set_seed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.GDSolver.solve"><code class="docutils literal notranslate"><span class="pre">GDSolver.solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.MPPISolver"><code class="docutils literal notranslate"><span class="pre">MPPISolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.MPPISolver.action_dim"><code class="docutils literal notranslate"><span class="pre">MPPISolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.MPPISolver.compute_trajectory_weights"><code class="docutils literal notranslate"><span class="pre">MPPISolver.compute_trajectory_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.MPPISolver.configure"><code class="docutils literal notranslate"><span class="pre">MPPISolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.MPPISolver.horizon"><code class="docutils literal notranslate"><span class="pre">MPPISolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.MPPISolver.init_action_distrib"><code class="docutils literal notranslate"><span class="pre">MPPISolver.init_action_distrib()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.MPPISolver.n_envs"><code class="docutils literal notranslate"><span class="pre">MPPISolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.MPPISolver.solve"><code class="docutils literal notranslate"><span class="pre">MPPISolver.solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.NevergradSolver"><code class="docutils literal notranslate"><span class="pre">NevergradSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.NevergradSolver.action_dim"><code class="docutils literal notranslate"><span class="pre">NevergradSolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.NevergradSolver.configure"><code class="docutils literal notranslate"><span class="pre">NevergradSolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.NevergradSolver.horizon"><code class="docutils literal notranslate"><span class="pre">NevergradSolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.NevergradSolver.n_envs"><code class="docutils literal notranslate"><span class="pre">NevergradSolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.NevergradSolver.solve"><code class="docutils literal notranslate"><span class="pre">NevergradSolver.solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.RandomSolver"><code class="docutils literal notranslate"><span class="pre">RandomSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.RandomSolver.__init__"><code class="docutils literal notranslate"><span class="pre">RandomSolver.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.RandomSolver.action_dim"><code class="docutils literal notranslate"><span class="pre">RandomSolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.RandomSolver.configure"><code class="docutils literal notranslate"><span class="pre">RandomSolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.RandomSolver.horizon"><code class="docutils literal notranslate"><span class="pre">RandomSolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.RandomSolver.n_envs"><code class="docutils literal notranslate"><span class="pre">RandomSolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.RandomSolver.solve"><code class="docutils literal notranslate"><span class="pre">RandomSolver.solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.Solver"><code class="docutils literal notranslate"><span class="pre">Solver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.Solver.action_dim"><code class="docutils literal notranslate"><span class="pre">Solver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.Solver.configure"><code class="docutils literal notranslate"><span class="pre">Solver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.Solver.horizon"><code class="docutils literal notranslate"><span class="pre">Solver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.Solver.n_envs"><code class="docutils literal notranslate"><span class="pre">Solver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.Solver.solve"><code class="docutils literal notranslate"><span class="pre">Solver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stable_worldmodel.wm/">stable_worldmodel.wm package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.wm/#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.wm/#module-stable_worldmodel.wm.dinowm">stable_worldmodel.wm.dinowm module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.Attention"><code class="docutils literal notranslate"><span class="pre">Attention</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.Attention.forward"><code class="docutils literal notranslate"><span class="pre">Attention.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.Attention.generate_mask_matrix"><code class="docutils literal notranslate"><span class="pre">Attention.generate_mask_matrix()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.CausalPredictor"><code class="docutils literal notranslate"><span class="pre">CausalPredictor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.CausalPredictor.forward"><code class="docutils literal notranslate"><span class="pre">CausalPredictor.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.DINOWM"><code class="docutils literal notranslate"><span class="pre">DINOWM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.DINOWM.decode"><code class="docutils literal notranslate"><span class="pre">DINOWM.decode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.DINOWM.encode"><code class="docutils literal notranslate"><span class="pre">DINOWM.encode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.DINOWM.get_cost"><code class="docutils literal notranslate"><span class="pre">DINOWM.get_cost()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.DINOWM.predict"><code class="docutils literal notranslate"><span class="pre">DINOWM.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.DINOWM.replace_action_in_embedding"><code class="docutils literal notranslate"><span class="pre">DINOWM.replace_action_in_embedding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.DINOWM.rollout"><code class="docutils literal notranslate"><span class="pre">DINOWM.rollout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.DINOWM.split_embedding"><code class="docutils literal notranslate"><span class="pre">DINOWM.split_embedding()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.Decoder"><code class="docutils literal notranslate"><span class="pre">Decoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.Decoder.forward"><code class="docutils literal notranslate"><span class="pre">Decoder.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.Embedder"><code class="docutils literal notranslate"><span class="pre">Embedder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.Embedder.forward"><code class="docutils literal notranslate"><span class="pre">Embedder.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.Encoder"><code class="docutils literal notranslate"><span class="pre">Encoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.Encoder.forward"><code class="docutils literal notranslate"><span class="pre">Encoder.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.FeedForward"><code class="docutils literal notranslate"><span class="pre">FeedForward</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.FeedForward.forward"><code class="docutils literal notranslate"><span class="pre">FeedForward.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.Quantize"><code class="docutils literal notranslate"><span class="pre">Quantize</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.Quantize.embed_code"><code class="docutils literal notranslate"><span class="pre">Quantize.embed_code()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.Quantize.forward"><code class="docutils literal notranslate"><span class="pre">Quantize.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.ResBlock"><code class="docutils literal notranslate"><span class="pre">ResBlock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.ResBlock.forward"><code class="docutils literal notranslate"><span class="pre">ResBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.Transformer"><code class="docutils literal notranslate"><span class="pre">Transformer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.Transformer.forward"><code class="docutils literal notranslate"><span class="pre">Transformer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.VQVAE"><code class="docutils literal notranslate"><span class="pre">VQVAE</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.VQVAE.decode"><code class="docutils literal notranslate"><span class="pre">VQVAE.decode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.VQVAE.decode_code"><code class="docutils literal notranslate"><span class="pre">VQVAE.decode_code()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.VQVAE.forward"><code class="docutils literal notranslate"><span class="pre">VQVAE.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.all_reduce"><code class="docutils literal notranslate"><span class="pre">all_reduce()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dinowm.get_world_size"><code class="docutils literal notranslate"><span class="pre">get_world_size()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.wm/#module-stable_worldmodel.wm.dreamer">stable_worldmodel.wm.dreamer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.wm/#module-stable_worldmodel.wm.dummy">stable_worldmodel.wm.dummy module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dummy.DummyWorldModel"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dummy.DummyWorldModel.encode"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel.encode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dummy.DummyWorldModel.get_cost"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel.get_cost()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dummy.DummyWorldModel.predict"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel.predict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.dummy.transform"><code class="docutils literal notranslate"><span class="pre">transform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.wm/#module-stable_worldmodel.wm.frame">stable_worldmodel.wm.frame module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.wm/#module-stable_worldmodel.wm.tdmpc">stable_worldmodel.wm.tdmpc module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_worldmodel.wm/#module-stable_worldmodel.wm">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.DINOWM"><code class="docutils literal notranslate"><span class="pre">DINOWM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.DINOWM.decode"><code class="docutils literal notranslate"><span class="pre">DINOWM.decode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.DINOWM.encode"><code class="docutils literal notranslate"><span class="pre">DINOWM.encode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.DINOWM.get_cost"><code class="docutils literal notranslate"><span class="pre">DINOWM.get_cost()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.DINOWM.predict"><code class="docutils literal notranslate"><span class="pre">DINOWM.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.DINOWM.replace_action_in_embedding"><code class="docutils literal notranslate"><span class="pre">DINOWM.replace_action_in_embedding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.DINOWM.rollout"><code class="docutils literal notranslate"><span class="pre">DINOWM.rollout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.DINOWM.split_embedding"><code class="docutils literal notranslate"><span class="pre">DINOWM.split_embedding()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.DummyWorldModel"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.DummyWorldModel.encode"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel.encode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.DummyWorldModel.get_cost"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel.get_cost()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_worldmodel.wm/#stable_worldmodel.wm.DummyWorldModel.predict"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#submodules'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
</section>
<section id="module-stable_worldmodel.cli">
<span id="stable-worldmodel-cli-module"></span><h2>stable_worldmodel.cli module<a class="headerlink" href="#module-stable_worldmodel.cli" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#module-stable_worldmodel.cli'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>Command-line interface for stable-worldmodel.</p>
<p>This module provides CLI commands for managing and inspecting stable-worldmodel
resources including datasets, models, and world environments. The CLI uses the
Typer framework with Rich formatting for an enhanced terminal experience.</p>
<dl class="simple">
<dt>Available commands:</dt><dd><ul class="simple">
<li><p>list: List cached models, datasets, or worlds</p></li>
<li><p>show: Display detailed information about datasets or worlds</p></li>
<li><p>delete: Remove models or datasets from cache</p></li>
</ul>
</dd>
<dt>The CLI can be invoked via:</dt><dd><ul class="simple">
<li><p><cite>stable-worldmodel &lt;command&gt;</cite></p></li>
<li><p><cite>swm &lt;command&gt;</cite></p></li>
<li><p><cite>python -m stable_worldmodel.cli &lt;command&gt;</cite></p></li>
</ul>
</dd>
</dl>
<p>Typical usage examples:</p>
<blockquote>
<div><p>List all cached datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">$ swm list dataset
</span></code></pre></div>
</div>
<p>Show information about a specific world:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">$ swm show world swm/SimplePointMaze-v0
</span></code></pre></div>
</div>
<p>Delete a cached dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">$ swm delete dataset my-dataset
</span></code></pre></div>
</div>
<p>Show version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">$ swm --version
</span></code></pre></div>
</div>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.cli.common">
<span class="sig-name descname"><span class="pre">common</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version:</span> <span class="pre">~types.Annotated[bool</span> <span class="pre">|</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f9fe087d110&gt;]</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/cli/#common"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.cli.common" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.cli.common'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Common options for all stable-worldmodel commands.</p>
<p>This callback provides global options that apply to all CLI commands.
Currently only supports the â€“version flag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>version</strong> (<em>Optional</em><em>[</em><em>bool</em><em>]</em><em>, </em><em>optional</em>) â€“ If True, display version and exit.
Defaults to None.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.cli.delete">
<span class="sig-name descname"><span class="pre">delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">kind:</span> <span class="pre">~typing.Annotated[str,</span> <span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f9fe0893e10&gt;],</span> <span class="pre">names:</span> <span class="pre">~typing.Annotated[list[str],</span> <span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f9fe0893e50&gt;]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/cli/#delete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.cli.delete" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.cli.delete'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Delete models or datasets from cache directory.</p>
<p>Permanently removes specified models or datasets from the local cache directory.
Requires user confirmation before deletion. This operation cannot be undone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kind</strong> (<em>str</em>) â€“ Type of resource to delete. Must be either:
- â€˜modelâ€™: Delete cached world models
- â€˜datasetâ€™: Delete cached datasets</p></li>
<li><p><strong>names</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) â€“ One or more names of resources to delete. All specified
names must exist in cache.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>typer.Abort</strong> â€“ If kind is invalid, specified names not found in cache,
    or user cancels the confirmation prompt.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Delete a single dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">$ swm delete dataset my-dataset
</span></code></pre></div>
</div>
<p>Delete multiple models:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">$ swm delete model model1 model2
</span></code></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This operation permanently deletes data and cannot be undone. The command
will prompt for confirmation before proceeding.</p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.cli.display_dataset_info">
<span class="sig-name descname"><span class="pre">display_dataset_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/stable_worldmodel/cli/#display_dataset_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.cli.display_dataset_info" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.cli.display_dataset_info'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Display dataset information in a formatted panel with tables.</p>
<p>Prints a Rich panel showing dataset metadata including columns, episode count,
shapes, and variation information in a two-table layout.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>info</strong> (<a class="reference internal" href="#stable_worldmodel.spaces.Dict" title="stable_worldmodel.spaces.Dict"><em>Dict</em></a><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) â€“ Dataset metadata dictionary containing keys:
- â€˜nameâ€™: Dataset name
- â€˜columnsâ€™: List of data columns
- â€˜num_episodesâ€™: Total number of episodes
- â€˜num_stepsâ€™: Total number of steps
- â€˜obs_shapeâ€™: Observation tensor shape
- â€˜action_shapeâ€™: Action tensor shape
- â€˜goal_shapeâ€™: Goal tensor shape
- â€˜variationâ€™: Variation space structure</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">stable_worldmodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">data</span>
</span><span id="line-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">info</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dataset_info</span><span class="p">(</span><span class="s2">"simple-pointmaze"</span><span class="p">)</span>
</span><span id="line-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">display_dataset_info</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.cli.display_world_info">
<span class="sig-name descname"><span class="pre">display_world_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/stable_worldmodel/cli/#display_world_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.cli.display_world_info" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.cli.display_world_info'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Display world environment information in a formatted panel.</p>
<p>Prints a Rich panel showing the worldâ€™s observation space, action space,
and variation space in a hierarchical, color-coded format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>info</strong> (<a class="reference internal" href="#stable_worldmodel.spaces.Dict" title="stable_worldmodel.spaces.Dict"><em>Dict</em></a><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) â€“ World metadata dictionary containing keys:
- â€˜nameâ€™: World environment name
- â€˜observation_spaceâ€™: Observation space structure
- â€˜action_spaceâ€™: Action space structure
- â€˜variationâ€™: Variation space structure</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">stable_worldmodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">data</span>
</span><span id="line-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">info</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">world_info</span><span class="p">(</span><span class="s2">"swm/SimplePointMaze-v0"</span><span class="p">)</span>
</span><span id="line-3"><span class="gp">&gt;&gt;&gt; </span><span class="n">display_world_info</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.cli.list_cmd">
<span class="sig-name descname"><span class="pre">list_cmd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">kind:</span> <span class="pre">~typing.Annotated[str,</span> <span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f9fe0893f10&gt;]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/cli/#list_cmd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.cli.list_cmd" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.cli.list_cmd'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>List cached stable-worldmodel resources.</p>
<p>Displays a table of all cached models, datasets, or worlds stored in the
stable-worldmodel cache directory. Useful for seeing what resources are
available locally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kind</strong> (<em>str</em>) â€“ Type of resource to list. Must be one of:
- â€˜modelâ€™: List cached world models
- â€˜datasetâ€™: List cached datasets
- â€˜worldâ€™: List registered world environments</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>typer.Abort</strong> â€“ If kind is not â€˜modelâ€™, â€˜datasetâ€™, or â€˜worldâ€™.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>List all cached datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">$ swm list dataset
</span></code></pre></div>
</div>
<p>List all available worlds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">$ swm list world
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.cli.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">kind:</span> <span class="pre">~typing.Annotated[str,</span> <span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f9fe08617d0&gt;],</span> <span class="pre">names:</span> <span class="pre">~types.Annotated[list[str]</span> <span class="pre">|</span> <span class="pre">None,</span> <span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7fa021c55810&gt;]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">all:</span> <span class="pre">~typing.Annotated[bool,</span> <span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f9fe0893c50&gt;]</span> <span class="pre">=</span> <span class="pre">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/cli/#show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.cli.show" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.cli.show'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Show detailed information about datasets or worlds.</p>
<p>Displays comprehensive information about specified datasets or world environments
including their structure, spaces, and variations. Information is presented in
formatted panels with hierarchical trees and tables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kind</strong> (<em>str</em>) â€“ Type of resource to show. Must be either:
- â€˜datasetâ€™: Show dataset information
- â€˜worldâ€™: Show world environment information</p></li>
<li><p><strong>names</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>optional</em>) â€“ Specific names to display. Can provide
multiple names. Defaults to None.</p></li>
<li><p><strong>all</strong> (<em>bool</em><em>, </em><em>optional</em>) â€“ If True, show information for all cached resources of
the specified kind. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>typer.Abort</strong> â€“ If kind is invalid, no names provided without â€“all flag,
    or if specified names are not found in cache.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Show a specific dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">$ swm show dataset simple-pointmaze
</span></code></pre></div>
</div>
<p>Show multiple datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">$ swm show dataset dataset1 dataset2
</span></code></pre></div>
</div>
<p>Show all cached datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">$ swm show dataset --all
</span></code></pre></div>
</div>
<p>Show a specific world:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">$ swm show world swm/SimplePointMaze-v0
</span></code></pre></div>
</div>
</dd></dl>
</section>
<section id="module-stable_worldmodel.data">
<span id="stable-worldmodel-data-module"></span><h2>stable_worldmodel.data module<a class="headerlink" href="#module-stable_worldmodel.data" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#module-stable_worldmodel.data'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>Data management and dataset utilities for Stable World Model.</p>
<p>This module provides utilities for managing datasets, models, and world
information. It includes functionality for loading multi-step trajectories,
querying cached data, and retrieving metadata about environments.</p>
<dl class="simple">
<dt>The module supports:</dt><dd><ul class="simple">
<li><p>Multi-step trajectory datasets with frame skipping</p></li>
<li><p>Dataset and model cache management</p></li>
<li><p>World environment introspection</p></li>
<li><p>Gymnasium space metadata extraction</p></li>
</ul>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.data.SpaceInfo">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SpaceInfo</span></span><a class="reference internal" href="../_modules/stable_worldmodel/data/#SpaceInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.SpaceInfo" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.SpaceInfo'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TypedDict</span></code></p>
<p>Type specification for Gymnasium space metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) â€“ Dimensions of the space.</p></li>
<li><p><strong>type</strong> (<em>str</em>) â€“ Class name of the space (e.g., â€˜Boxâ€™, â€˜Discreteâ€™).</p></li>
<li><p><strong>dtype</strong> (<em>str</em>) â€“ Data type of the space elements.</p></li>
<li><p><strong>low</strong> (<em>Any</em>) â€“ Lower bounds for Box spaces.</p></li>
<li><p><strong>high</strong> (<em>Any</em>) â€“ Upper bounds for Box spaces.</p></li>
<li><p><strong>n</strong> (<em>int</em>) â€“ Number of discrete values for Discrete spaces.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.SpaceInfo.dtype">
<span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#stable_worldmodel.data.SpaceInfo.dtype" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.SpaceInfo.dtype'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.SpaceInfo.high">
<span class="sig-name descname"><span class="pre">high</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#stable_worldmodel.data.SpaceInfo.high" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.SpaceInfo.high'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.SpaceInfo.low">
<span class="sig-name descname"><span class="pre">low</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#stable_worldmodel.data.SpaceInfo.low" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.SpaceInfo.low'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.SpaceInfo.n">
<span class="sig-name descname"><span class="pre">n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#stable_worldmodel.data.SpaceInfo.n" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.SpaceInfo.n'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.SpaceInfo.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#stable_worldmodel.data.SpaceInfo.shape" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.SpaceInfo.shape'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.SpaceInfo.type">
<span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#stable_worldmodel.data.SpaceInfo.type" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.SpaceInfo.type'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.data.StepsDataset">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StepsDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frameskip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/data/#StepsDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.StepsDataset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.StepsDataset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">HFDataset</span></code></p>
<p>Dataset for loading multi-step trajectory sequences.</p>
<p>This dataset loads sequences of consecutive steps from episodic data,
supporting frame skipping and automatic image loading from file paths.
Inherits from stable_pretrainingâ€™s HFDataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dir</strong> (<em>Path</em>) â€“ Directory containing the dataset.</p></li>
<li><p><strong>num_steps</strong> (<em>int</em>) â€“ Number of steps per sequence.</p></li>
<li><p><strong>frameskip</strong> (<em>int</em>) â€“ Number of steps to skip between frames.</p></li>
<li><p><strong>episodes</strong> (<em>np.ndarray</em>) â€“ Array of unique episode indices.</p></li>
<li><p><strong>episode_slices</strong> (<em>dict</em>) â€“ Mapping from episode index to dataset indices.</p></li>
<li><p><strong>cum_slices</strong> (<em>np.ndarray</em>) â€“ Cumulative sum of valid samples per episode.</p></li>
<li><p><strong>idx_to_ep</strong> (<em>np.ndarray</em>) â€“ Mapping from sample index to episode.</p></li>
<li><p><strong>img_cols</strong> (<em>set</em>) â€“ Set of column names containing image paths.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.data.StepsDataset.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frameskip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/data/#StepsDataset.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.StepsDataset.__init__" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.StepsDataset.__init__'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Initialize the StepsDataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) â€“ Name or path of the dataset within cache directory.</p></li>
<li><p><strong>*args</strong> â€“ Additional arguments passed to parent class.</p></li>
<li><p><strong>num_steps</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Number of consecutive steps per sample. Defaults to 2.</p></li>
<li><p><strong>frameskip</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Number of steps between sampled frames. Defaults to 1.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em><em>, </em><em>optional</em>) â€“ Cache directory path. Defaults to None (uses default).</p></li>
<li><p><strong>**kwargs</strong> â€“ Additional keyword arguments passed to parent class.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> â€“ If required columns are missing from dataset.</p></li>
<li><p><strong>ValueError</strong> â€“ If episodes are too short for the requested num_steps and frameskip.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.data.StepsDataset.get_episode_slice">
<span class="sig-name descname"><span class="pre">get_episode_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episode_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episode_indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/data/#StepsDataset.get_episode_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.StepsDataset.get_episode_slice" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.StepsDataset.get_episode_slice'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Get dataset indices for a specific episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>episode_idx</strong> (<em>int</em>) â€“ Episode index to retrieve.</p></li>
<li><p><strong>episode_indices</strong> (<em>array-like</em>) â€“ Array of episode indices for all steps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Indices of steps belonging to the specified episode.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> â€“ If episode is too short for num_steps and frameskip.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.data.StepsDataset.infer_img_path_columns">
<span class="sig-name descname"><span class="pre">infer_img_path_columns</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/data/#StepsDataset.infer_img_path_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.StepsDataset.infer_img_path_columns" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.StepsDataset.infer_img_path_columns'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Infer which dataset columns contain image file paths.</p>
<p>Checks the first dataset element to identify string columns with
common image file extensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set of column names containing image file paths.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>set</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.data.VariationInfo">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">VariationInfo</span></span><a class="reference internal" href="../_modules/stable_worldmodel/data/#VariationInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.VariationInfo" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.VariationInfo'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TypedDict</span></code></p>
<p>Type specification for environment variation metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>has_variation</strong> (<em>bool</em>) â€“ Whether the environment supports variations.</p></li>
<li><p><strong>type</strong> (<em>str</em><em> | </em><em>None</em>) â€“ Class name of the variation space if it exists.</p></li>
<li><p><strong>names</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) â€“ List of variation parameter names.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.VariationInfo.has_variation">
<span class="sig-name descname"><span class="pre">has_variation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#stable_worldmodel.data.VariationInfo.has_variation" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.VariationInfo.has_variation'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.VariationInfo.names">
<span class="sig-name descname"><span class="pre">names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#stable_worldmodel.data.VariationInfo.names" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.VariationInfo.names'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.VariationInfo.type">
<span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#stable_worldmodel.data.VariationInfo.type" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.VariationInfo.type'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.data.WorldInfo">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">WorldInfo</span></span><a class="reference internal" href="../_modules/stable_worldmodel/data/#WorldInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.WorldInfo" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.WorldInfo'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TypedDict</span></code></p>
<p>Type specification for world environment information.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) â€“ Name/ID of the world environment.</p></li>
<li><p><strong>observation_space</strong> (<a class="reference internal" href="#stable_worldmodel.data.SpaceInfo" title="stable_worldmodel.data.SpaceInfo"><em>stable_worldmodel.data.SpaceInfo</em></a>) â€“ Metadata about the observation space.</p></li>
<li><p><strong>action_space</strong> (<a class="reference internal" href="#stable_worldmodel.data.SpaceInfo" title="stable_worldmodel.data.SpaceInfo"><em>stable_worldmodel.data.SpaceInfo</em></a>) â€“ Metadata about the action space.</p></li>
<li><p><strong>variation</strong> (<a class="reference internal" href="#stable_worldmodel.data.VariationInfo" title="stable_worldmodel.data.VariationInfo"><em>stable_worldmodel.data.VariationInfo</em></a>) â€“ Information about environment variations.</p></li>
<li><p><strong>config</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) â€“ Additional configuration parameters.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.WorldInfo.action_space">
<span class="sig-name descname"><span class="pre">action_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#stable_worldmodel.data.SpaceInfo" title="stable_worldmodel.data.SpaceInfo"><span class="pre">SpaceInfo</span></a></em><a class="headerlink" href="#stable_worldmodel.data.WorldInfo.action_space" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.WorldInfo.action_space'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.WorldInfo.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#stable_worldmodel.data.WorldInfo.config" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.WorldInfo.config'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.WorldInfo.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#stable_worldmodel.data.WorldInfo.name" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.WorldInfo.name'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.WorldInfo.observation_space">
<span class="sig-name descname"><span class="pre">observation_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#stable_worldmodel.data.SpaceInfo" title="stable_worldmodel.data.SpaceInfo"><span class="pre">SpaceInfo</span></a></em><a class="headerlink" href="#stable_worldmodel.data.WorldInfo.observation_space" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.WorldInfo.observation_space'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.WorldInfo.variation">
<span class="sig-name descname"><span class="pre">variation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#stable_worldmodel.data.VariationInfo" title="stable_worldmodel.data.VariationInfo"><span class="pre">VariationInfo</span></a></em><a class="headerlink" href="#stable_worldmodel.data.WorldInfo.variation" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.WorldInfo.variation'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.dataset_info">
<span class="sig-name descname"><span class="pre">dataset_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/data/#dataset_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.dataset_info" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.dataset_info'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Get metadata about a cached dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) â€“ Name of the dataset.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Dictionary containing dataset metadata including:</dt><dd><ul class="simple">
<li><p>name: Dataset name</p></li>
<li><p>num_episodes: Number of unique episodes</p></li>
<li><p>num_steps: Total number of steps</p></li>
<li><p>columns: List of column names</p></li>
<li><p>obs_shape: Shape of observation images</p></li>
<li><p>action_shape: Shape of action vectors</p></li>
<li><p>goal_shape: Shape of goal images</p></li>
<li><p>variation: Dict with variation information</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> â€“ If dataset is not found in cache.</p></li>
<li><p><strong>AssertionError</strong> â€“ If required columns are missing.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.delete_dataset">
<span class="sig-name descname"><span class="pre">delete_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/data/#delete_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.delete_dataset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.delete_dataset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Delete a cached dataset and its associated files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) â€“ Name of the dataset to delete.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Prints success or error messages to console.</p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.delete_model">
<span class="sig-name descname"><span class="pre">delete_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/data/#delete_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.delete_model" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.delete_model'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Delete cached model checkpoint files.</p>
<p>Removes all checkpoint files (weights and object files) matching the
given model name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) â€“ Name of the model to delete.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Prints success or error messages to console for each file deleted.</p>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.get_cache_dir">
<span class="sig-name descname"><span class="pre">get_cache_dir</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Path</span></span></span><a class="reference internal" href="../_modules/stable_worldmodel/data/#get_cache_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.get_cache_dir" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.get_cache_dir'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Get the cache directory for stable_worldmodel data.</p>
<p>The cache directory can be customized via the STABLEWM_HOME environment
variable. If not set, defaults to ~/.stable_worldmodel.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path to the cache directory. Directory is created if it doesnâ€™t exist.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Path</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.is_image">
<span class="sig-name descname"><span class="pre">is_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/data/#is_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.is_image" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.is_image'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Check if input is a valid image array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> â€“ Input to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>True if x is a uint8 numpy array with shape (H, W, C) where</dt><dd><p>C is 1 (grayscale), 3 (RGB), or 4 (RGBA).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.list_datasets">
<span class="sig-name descname"><span class="pre">list_datasets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/data/#list_datasets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.list_datasets" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.list_datasets'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>List all cached datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Names of all dataset directories in the cache.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[str]</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.list_models">
<span class="sig-name descname"><span class="pre">list_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/data/#list_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.list_models" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.list_models'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>List all cached model checkpoints.</p>
<p>Searches for files matching the pattern <cite>&lt;name&gt;_weights*.ckpt</cite> or
<cite>&lt;name&gt;_object.ckpt</cite> and returns unique model names.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Sorted list of model names found in cache.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[str]</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.list_worlds">
<span class="sig-name descname"><span class="pre">list_worlds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/data/#list_worlds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.list_worlds" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.list_worlds'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>List all registered world environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Sorted list of world environment IDs.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[str]</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.world_info">
<span class="sig-name descname"><span class="pre">world_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(224,</span> <span class="pre">224)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rgb_array'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><a class="reference internal" href="#stable_worldmodel.data.WorldInfo" title="stable_worldmodel.data.WorldInfo"><span class="pre">WorldInfo</span></a></span></span><a class="reference internal" href="../_modules/stable_worldmodel/data/#world_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.world_info" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.data.world_info'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Get metadata about a world environment.</p>
<p>Creates a temporary world instance to extract observation space, action
space, and variation information. Results are cached for efficiency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> â€“ ID of the world environment.</p></li>
<li><p><strong>image_shape</strong> â€“ Desired image shape for rendering. Defaults to (224, 224).</p></li>
<li><p><strong>render_mode</strong> â€“ Rendering mode for the environment. Defaults to â€œrgb_arrayâ€.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing world metadata including spaces and variations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stable_worldmodel.data.WorldInfo" title="stable_worldmodel.data.WorldInfo">WorldInfo</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> â€“ If world name is not registered.</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-stable_worldmodel.policy">
<span id="stable-worldmodel-policy-module"></span><h2>stable_worldmodel.policy module<a class="headerlink" href="#module-stable_worldmodel.policy" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#module-stable_worldmodel.policy'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.policy.AutoCostModel">
<span class="sig-name descname"><span class="pre">AutoCostModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#AutoCostModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.AutoCostModel" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.AutoCostModel'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.policy.BasePolicy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BasePolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#BasePolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.BasePolicy" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.BasePolicy'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for agent policies.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.BasePolicy.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#BasePolicy.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.BasePolicy.get_action" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.BasePolicy.get_action'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Get action from the policy given the observation.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.BasePolicy.set_env">
<span class="sig-name descname"><span class="pre">set_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#BasePolicy.set_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.BasePolicy.set_env" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.BasePolicy.set_env'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.policy.ExpertPolicy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ExpertPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#ExpertPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.ExpertPolicy" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.ExpertPolicy'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <a class="reference internal" href="#stable_worldmodel.policy.BasePolicy" title="stable_worldmodel.policy.BasePolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePolicy</span></code></a></p>
<p>Expert Policy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.ExpertPolicy.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_obs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#ExpertPolicy.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.ExpertPolicy.get_action" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.ExpertPolicy.get_action'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Get action from the policy given the observation.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.policy.PlanConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PlanConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">horizon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">receding_horizon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_block</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warm_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#PlanConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.PlanConfig" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.PlanConfig'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration for the planning process.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.policy.PlanConfig.action_block">
<span class="sig-name descname"><span class="pre">action_block</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#stable_worldmodel.policy.PlanConfig.action_block" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.PlanConfig.action_block'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.policy.PlanConfig.history_len">
<span class="sig-name descname"><span class="pre">history_len</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#stable_worldmodel.policy.PlanConfig.history_len" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.PlanConfig.history_len'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.policy.PlanConfig.horizon">
<span class="sig-name descname"><span class="pre">horizon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#stable_worldmodel.policy.PlanConfig.horizon" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.PlanConfig.horizon'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.policy.PlanConfig.plan_len">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plan_len</span></span><a class="headerlink" href="#stable_worldmodel.policy.PlanConfig.plan_len" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.PlanConfig.plan_len'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.policy.PlanConfig.receding_horizon">
<span class="sig-name descname"><span class="pre">receding_horizon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#stable_worldmodel.policy.PlanConfig.receding_horizon" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.PlanConfig.receding_horizon'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.policy.PlanConfig.warm_start">
<span class="sig-name descname"><span class="pre">warm_start</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#stable_worldmodel.policy.PlanConfig.warm_start" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.PlanConfig.warm_start'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.policy.RandomPolicy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RandomPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#RandomPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.RandomPolicy" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.RandomPolicy'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <a class="reference internal" href="#stable_worldmodel.policy.BasePolicy" title="stable_worldmodel.policy.BasePolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePolicy</span></code></a></p>
<p>Random Policy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.RandomPolicy.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#RandomPolicy.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.RandomPolicy.get_action" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.RandomPolicy.get_action'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Get action from the policy given the observation.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.RandomPolicy.set_seed">
<span class="sig-name descname"><span class="pre">set_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#RandomPolicy.set_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.RandomPolicy.set_seed" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.RandomPolicy.set_seed'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.policy.Transformable">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Transformable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#Transformable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.Transformable" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.Transformable'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>Protocol for input transformation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.Transformable.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#Transformable.inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.Transformable.inverse_transform" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.Transformable.inverse_transform'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Revert pre-processed</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.Transformable.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#Transformable.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.Transformable.transform" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.Transformable.transform'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Pre-process</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.policy.WorldModelPolicy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">WorldModelPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../stable_worldmodel.solver/#stable_worldmodel.solver.solver.Solver" title="stable_worldmodel.solver.solver.Solver"><span class="pre">Solver</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#stable_worldmodel.policy.PlanConfig" title="stable_worldmodel.policy.PlanConfig"><span class="pre">PlanConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#stable_worldmodel.policy.Transformable" title="stable_worldmodel.policy.Transformable"><span class="pre">Transformable</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">callable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#WorldModelPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.WorldModelPolicy" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.WorldModelPolicy'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <a class="reference internal" href="#stable_worldmodel.policy.BasePolicy" title="stable_worldmodel.policy.BasePolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePolicy</span></code></a></p>
<p>World Model Policy using a planning solver.</p>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.policy.WorldModelPolicy.flatten_receding_horizon">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flatten_receding_horizon</span></span><a class="headerlink" href="#stable_worldmodel.policy.WorldModelPolicy.flatten_receding_horizon" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.WorldModelPolicy.flatten_receding_horizon'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.WorldModelPolicy.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#WorldModelPolicy.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.WorldModelPolicy.get_action" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.WorldModelPolicy.get_action'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Get action from the policy given the observation.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.WorldModelPolicy.set_env">
<span class="sig-name descname"><span class="pre">set_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#WorldModelPolicy.set_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.WorldModelPolicy.set_env" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.policy.WorldModelPolicy.set_env'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
</dd></dl>
</section>
<section id="module-stable_worldmodel.spaces">
<span id="stable-worldmodel-spaces-module"></span><h2>stable_worldmodel.spaces module<a class="headerlink" href="#module-stable_worldmodel.spaces" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#module-stable_worldmodel.spaces'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>Extended Gymnasium spaces with state tracking and constraint support.</p>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Box" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Box'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Box</span></code></p>
<p>Extended continuous box space with state tracking and constraint support.</p>
<p>This class extends <code class="docutils literal notranslate"><span class="pre">gymnasium.spaces.Box</span></code> to add state management and
optional constraint validation. It represents bounded continuous values
with configurable shape, dtype, and custom constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_value</strong> (<em>np.ndarray</em>) â€“ The initial value for the space.</p></li>
<li><p><strong>value</strong> (<em>np.ndarray</em>) â€“ The current value of the space.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em>) â€“ Optional function that returns True if a
value satisfies custom constraints beyond the box boundaries.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Create a 2D position space constrained to a circle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="line-2">
</span><span id="line-3">
</span><span id="line-4"><span class="k">def</span><span class="w"> </span><span class="nf">in_circle</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
</span><span id="line-5">    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.0</span>
</span><span id="line-6">
</span><span id="line-7">
</span><span id="line-8"><span class="n">space</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span>
</span><span id="line-9">    <span class="n">low</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">]),</span>
</span><span id="line-10">    <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span>
</span><span id="line-11">    <span class="n">init_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>
</span><span id="line-12">    <span class="n">constrain_fn</span><span class="o">=</span><span class="n">in_circle</span><span class="p">,</span>
</span><span id="line-13"><span class="p">)</span>
</span><span id="line-14"><span class="n">position</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>  <span class="c1"># Only samples within unit circle</span>
</span></code></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The constraint function enables complex geometric or relational
constraints beyond simple box boundaries.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Box.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Box.__init__" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Box.__init__'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Initialize a Box space with state tracking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> â€“ Positional arguments passed to gymnasium.spaces.Box.</p></li>
<li><p><strong>init_value</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) â€“ Initial value for the space.
Must match the shape and dtype of the box. Defaults to None.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) â€“ Function that takes a numpy array
and returns True if the value satisfies custom constraints beyond
the box boundaries. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> â€“ Keyword arguments passed to gymnasium.spaces.Box.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Box.check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Box.check" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Box.check'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Validate the current space value.</p>
<p>Checks if the current value is within the box bounds and satisfies
the constraint function. Logs a warning if the constraint fails.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the current value is valid, False otherwise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box.contains">
<span class="sig-name descname"><span class="pre">contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Box.contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Box.contains" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Box.contains'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Check if value is valid and satisfies constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) â€“ The value to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>True if x is within box bounds and satisfies the constraint</dt><dd><p>function, False otherwise.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box.init_value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.Box.init_value" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Box.init_value'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>The initial value of the space, returned by reset().</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Box.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Box.reset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Box.reset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Reset the space value to its initial value.</p>
<p>Sets the current value back to the init_value specified during
initialization.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn_after_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Box.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Box.sample" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Box.sample'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Sample a random value using rejection sampling for constraints.</p>
<p>Repeatedly samples values until one satisfies the constraint function
or max_tries is reached. Optionally updates the spaceâ€™s current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> â€“ Positional arguments passed to gymnasium.spaces.Box.sample().</p></li>
<li><p><strong>max_tries</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Maximum number of sampling attempts before
raising an error. Defaults to 1000.</p></li>
<li><p><strong>warn_after_s</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Time threshold in seconds after which
to log a warning about slow sampling. Set to None to disable.
Defaults to 5.0.</p></li>
<li><p><strong>set_value</strong> (<em>bool</em><em>, </em><em>optional</em>) â€“ Whether to update the spaceâ€™s current
value with the sampled value. Defaults to True.</p></li>
<li><p><strong>**kwargs</strong> â€“ Keyword arguments passed to gymnasium.spaces.Box.sample().</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sampled array that satisfies the constraint function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> â€“ If no valid sample is found after max_tries attempts.</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box.value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.Box.value" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Box.value'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>The current value of the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Dict'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></p>
<p>Extended dictionary space with ordered sampling and nested support.</p>
<p>This class extends <code class="docutils literal notranslate"><span class="pre">gymnasium.spaces.Dict</span></code> to add state management,
constraint validation, and explicit sampling order control. It composes
multiple spaces into a hierarchical structure where dependencies between
variables can be handled through ordered sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> â€“ Positional arguments passed to gymnasium.spaces.Dict.</p></li>
<li><p><strong>init_value</strong> (<em>dict</em><em>, </em><em>optional</em>) â€“ Initial values for the space. If None,
derived from init_value of contained spaces.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) â€“ Function that returns True if the
complete dictionary satisfies custom constraints.</p></li>
<li><p><strong>sampling_order</strong> (<em>list</em><em>, </em><em>optional</em>) â€“ Explicit order for sampling keys.
If None, uses insertion order. Missing keys are appended.</p></li>
<li><p><strong>**kwargs</strong> â€“ Additional keyword arguments passed to Dict.</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>init_value</strong> (<em>dict</em>) â€“ Initial values for all contained spaces.</p></li>
<li><p><strong>value</strong> (<em>dict</em>) â€“ Current values of all contained spaces.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em>) â€“ Constraint validation function.</p></li>
<li><p><strong>sampling_order</strong> (<em>set</em>) â€“ Set of dotted paths for all variables in order.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Create a nested space with sampling order dependencies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="kn">from</span><span class="w"> </span><span class="nn">stable_worldmodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">spaces</span>
</span><span id="line-2"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="line-3">
</span><span id="line-4"><span class="n">config</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
</span><span id="line-5">    <span class="p">{</span>
</span><span id="line-6">        <span class="s2">"difficulty"</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">init_value</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="line-7">        <span class="s2">"world"</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
</span><span id="line-8">            <span class="p">{</span>
</span><span id="line-9">                <span class="s2">"width"</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">init_value</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span>
</span><span id="line-10">                <span class="s2">"height"</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">init_value</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span>
</span><span id="line-11">            <span class="p">}</span>
</span><span id="line-12">        <span class="p">),</span>
</span><span id="line-13">        <span class="s2">"player_pos"</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
</span><span id="line-14">            <span class="n">low</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
</span><span id="line-15">            <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">99</span><span class="p">,</span> <span class="mi">99</span><span class="p">]),</span>
</span><span id="line-16">            <span class="n">init_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">]),</span>
</span><span id="line-17">        <span class="p">),</span>
</span><span id="line-18">    <span class="p">},</span>
</span><span id="line-19">    <span class="n">sampling_order</span><span class="o">=</span><span class="p">[</span><span class="s2">"difficulty"</span><span class="p">,</span> <span class="s2">"world"</span><span class="p">,</span> <span class="s2">"player_pos"</span><span class="p">],</span>
</span><span id="line-20"><span class="p">)</span>
</span><span id="line-21">
</span><span id="line-22"><span class="c1"># Sample respects order</span>
</span><span id="line-23"><span class="n">state</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sampling order is crucial when variables have dependencies. For
example, sample world size before sampling positions within it.
Nested Dict spaces recursively apply their own sampling orders.</p>
<p><strong>Accessing values in constraint functions</strong>: When implementing
<code class="docutils literal notranslate"><span class="pre">constrain_fn</span></code> for Dict spaces, always use <code class="docutils literal notranslate"><span class="pre">self.value['key']['key2']</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">self['key']['key2'].value</span></code>. The <code class="docutils literal notranslate"><span class="pre">.value</span></code> property
recursively builds the complete value dictionary from the top level down,
ensuring all nested values are up-to-date and correctly structured. Direct
subspace access with <code class="docutils literal notranslate"><span class="pre">.value</span></code> only retrieves that specific subspaceâ€™s
value without the full context.</p>
<p>Note that direct subspace access (e.g., <code class="docutils literal notranslate"><span class="pre">self['key'].value</span></code>) is perfectly
fine for regular operations outside of constraint functions, such as reading
individual subspace values or debugging. The recommendation to use top-level
<code class="docutils literal notranslate"><span class="pre">.value</span></code> applies specifically to constraint functions where you need the
complete, consistent state of all nested spaces.</p>
<p>Example of proper constraint function usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="c1"># Example: In a class with Dict space attribute</span>
</span><span id="line-2"><span class="k">class</span><span class="w"> </span><span class="nc">Environment</span><span class="p">:</span>
</span><span id="line-3">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="line-4">        <span class="bp">self</span><span class="o">.</span><span class="n">config_space</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">({</span><span class="o">...</span><span class="p">})</span>
</span><span id="line-5">
</span><span id="line-6">    <span class="k">def</span><span class="w"> </span><span class="nf">validate_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="line-7">        <span class="c1"># âœ“ CORRECT: Access via .value at top level</span>
</span><span id="line-8">        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_space</span><span class="o">.</span><span class="n">value</span>
</span><span id="line-9">        <span class="k">return</span> <span class="n">values</span><span class="p">[</span><span class="s2">"player_pos"</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">values</span><span class="p">[</span><span class="s2">"world"</span><span class="p">][</span><span class="s2">"width"</span><span class="p">]</span>
</span><span id="line-10">
</span><span id="line-11">    <span class="k">def</span><span class="w"> </span><span class="nf">validate_wrong</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="line-12">        <span class="c1"># âœ— AVOID: Direct subspace access</span>
</span><span id="line-13">        <span class="k">return</span> <span class="p">(</span>
</span><span id="line-14">            <span class="bp">self</span><span class="o">.</span><span class="n">config_space</span><span class="p">[</span><span class="s2">"player_pos"</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="line-15">            <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_space</span><span class="p">[</span><span class="s2">"world"</span><span class="p">][</span><span class="s2">"width"</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
</span><span id="line-16">        <span class="p">)</span>
</span></code></pre></div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Dict.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict.__init__" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Dict.__init__'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Initialize a Dict space with state tracking and sampling order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> â€“ Positional arguments passed to gymnasium.spaces.Dict.</p></li>
<li><p><strong>init_value</strong> (<em>dict</em><em>, </em><em>optional</em>) â€“ Initial values for the space. If None,
derived from init_value of contained spaces. Defaults to None.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) â€“ Function that takes a dict and
returns True if the complete dictionary satisfies custom constraints.
Defaults to None.</p></li>
<li><p><strong>sampling_order</strong> (<em>list</em><em>, </em><em>optional</em>) â€“ Explicit order for sampling keys.
If None, uses insertion order. Missing keys are appended with warning.
Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> â€“ Keyword arguments passed to gymnasium.spaces.Dict.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> â€“ If sampling_order contains keys not present in spaces.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Dict.check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict.check" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Dict.check'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Validate all contained spacesâ€™ current values.</p>
<p>Checks each contained space using its check() method if available,
or falls back to contains(value). Optionally logs warnings for
failed checks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) â€“ If True, logs warnings for spaces that
fail validation. Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if all contained spaces have valid values, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.contains">
<span class="sig-name descname"><span class="pre">contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Dict.contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict.contains" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Dict.contains'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Check if value is a valid member of this space.</p>
<p>Validates that x is a dictionary containing all required keys with
values that satisfy each subspaceâ€™s constraints and the overall
constraint function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> â€“ The value to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>True if x is a valid dict with all keys present, all values</dt><dd><p>within subspace bounds, and satisfies the constraint function.
False otherwise.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.init_value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.Dict.init_value" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Dict.init_value'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Initial values for all contained spaces.</p>
<p>Constructs initial value dictionary from contained spacesâ€™ init_value
properties. Falls back to sampling if a space lacks init_value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping space keys to their initial values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.names">
<span class="sig-name descname"><span class="pre">names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Dict.names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict.names" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Dict.names'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Return all space keys including nested ones.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A list of all keys in the Dict space, with nested keys using dot notation.</dt><dd><p>For example, a nested dict with key â€œaâ€ containing subspace â€œbâ€ would produce â€œa.bâ€.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Dict.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict.reset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Dict.reset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Reset all contained spaces to their initial values.</p>
<p>Calls reset() on all contained spaces that have a reset method,
then sets this spaceâ€™s value to init_value.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn_after_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Dict.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict.sample" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Dict.sample'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Sample a random element from the Dict space.</p>
<p>Samples each subspace in the sampling order and ensures the result satisfies
any constraint functions. Uses rejection sampling if constraints are present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> â€“ Positional arguments passed to each subspaceâ€™s sample method.</p></li>
<li><p><strong>max_tries</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Maximum number of rejection sampling attempts.
Defaults to 1000.</p></li>
<li><p><strong>warn_after_s</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Issue a warning if sampling takes longer than
this many seconds. Set to None to disable warnings. Defaults to 5.0.</p></li>
<li><p><strong>set_value</strong> (<em>bool</em><em>, </em><em>optional</em>) â€“ Whether to set the internal value to the sampled value.
Defaults to True.</p></li>
<li><p><strong>**kwargs</strong> â€“ Additional keyword arguments passed to each subspaceâ€™s sample method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary with keys matching the space definition and values sampled</dt><dd><p>from their respective subspaces.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> â€“ If a valid sample is not found within max_tries attempts.</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.sampling_order">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sampling_order</span></span><a class="headerlink" href="#stable_worldmodel.spaces.Dict.sampling_order" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Dict.sampling_order'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Set of dotted paths for all variables in sampling order.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Set of strings representing dotted paths (e.g., â€˜parent.child.keyâ€™)</dt><dd><p>for all variables including nested Dict spaces.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>set</p>
</dd>
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Dict.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict.update" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Dict.update'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Update specific keys in the Dict space by resampling them.</p>
<p>Samples new values for the specified keys while maintaining the sampling order.
Uses dot notation for nested keys (e.g., â€œa.bâ€ for nested dict).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>keys</strong> (<em>container</em>) â€“ A container (list, set, etc.) of key names to resample.
Keys should use dot notation for nested spaces.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> â€“ If a specified key is not found in the Dict space.</p></li>
<li><p><strong>AssertionError</strong> â€“ If the updated values violate the space constraints.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.Dict.value" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Dict.value'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Current values of all contained spaces.</p>
<p>Constructs value dictionary from contained spacesâ€™ value properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping space keys to their current values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> â€“ If a contained space does not have a value property.</p>
</dd>
<dt class="field-even">Type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Discrete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Discrete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Discrete" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Discrete'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Discrete</span></code></p>
<p>Extended discrete space with state tracking and constraint support.</p>
<p>This class extends <code class="docutils literal notranslate"><span class="pre">gymnasium.spaces.Discrete</span></code> to add state management
and optional constraint validation. Unlike the standard discrete space,
this version maintains a current value and supports rejection sampling
via a custom constraint function.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_value</strong> (<em>int</em>) â€“ The initial value for the space.</p></li>
<li><p><strong>value</strong> (<em>int</em>) â€“ The current value of the space.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em>) â€“ Optional function that returns True if a
value satisfies custom constraints.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Create a discrete space that only accepts even numbers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">space</span> <span class="o">=</span> <span class="n">Discrete</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">init_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">constrain_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="line-2"><span class="n">value</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>  <span class="c1"># Samples even number and updates space.value</span>
</span><span id="line-3"><span class="n">space</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># Resets space.value back to 0 (init_value)</span>
</span></code></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">sample()</span></code> method uses rejection sampling when a constraint
function is provided, which may impact performance for difficult
constraints.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Discrete.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Discrete.__init__" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Discrete.__init__'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Initialize a Discrete space with state tracking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> â€“ Positional arguments passed to gymnasium.spaces.Discrete.</p></li>
<li><p><strong>init_value</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Initial value for the space. Defaults to None.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) â€“ Function that takes an int and returns
True if the value satisfies custom constraints. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> â€“ Keyword arguments passed to gymnasium.spaces.Discrete.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Discrete.check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Discrete.check" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Discrete.check'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Validate the current space value.</p>
<p>Checks if the current value is within the space bounds and satisfies
the constraint function. Logs a warning if the constraint fails.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the current value is valid, False otherwise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete.contains">
<span class="sig-name descname"><span class="pre">contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Discrete.contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Discrete.contains" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Discrete.contains'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Check if value is valid and satisfies constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>int</em>) â€“ The value to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>True if x is within bounds and satisfies the constraint</dt><dd><p>function, False otherwise.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete.init_value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.Discrete.init_value" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Discrete.init_value'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>The initial value of the space, returned by reset().</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Discrete.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Discrete.reset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Discrete.reset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Reset the space value to its initial value.</p>
<p>Sets the current value back to the init_value specified during
initialization.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn_after_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#Discrete.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Discrete.sample" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Discrete.sample'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Sample a random value using rejection sampling for constraints.</p>
<p>Repeatedly samples values until one satisfies the constraint function
or max_tries is reached. Optionally updates the spaceâ€™s current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> â€“ Positional arguments passed to gymnasium.spaces.Discrete.sample().</p></li>
<li><p><strong>max_tries</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Maximum number of sampling attempts before
raising an error. Defaults to 1000.</p></li>
<li><p><strong>warn_after_s</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Time threshold in seconds after which
to log a warning about slow sampling. Set to None to disable.
Defaults to 5.0.</p></li>
<li><p><strong>set_value</strong> (<em>bool</em><em>, </em><em>optional</em>) â€“ Whether to update the spaceâ€™s current
value with the sampled value. Defaults to True.</p></li>
<li><p><strong>**kwargs</strong> â€“ Keyword arguments passed to gymnasium.spaces.Discrete.sample().</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sampled value that satisfies the constraint function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> â€“ If no valid sample is found after max_tries attempts.</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete.value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.Discrete.value" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.Discrete.value'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>The current value of the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MultiDiscrete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#MultiDiscrete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.MultiDiscrete'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MultiDiscrete</span></code></p>
<p>Extended multi-discrete space with state tracking and constraint support.</p>
<p>This class extends <code class="docutils literal notranslate"><span class="pre">gymnasium.spaces.MultiDiscrete</span></code> to add state
management and optional constraint validation. It represents multiple
discrete variables with potentially different ranges (nvec), where each
variable maintains its own value and can be constrained.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_value</strong> (<em>np.ndarray</em>) â€“ The initial values for all discrete variables.</p></li>
<li><p><strong>value</strong> (<em>np.ndarray</em>) â€“ The current values of all discrete variables.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em>) â€“ Optional function that returns True if the
entire value array satisfies custom constraints.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Create a multi-discrete space for game difficulty settings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="line-2">
</span><span id="line-3"><span class="n">space</span> <span class="o">=</span> <span class="n">MultiDiscrete</span><span class="p">(</span>
</span><span id="line-4">    <span class="n">nvec</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>  <span class="c1"># [enemy_count, speed_level, spawn_rate]</span>
</span><span id="line-5">    <span class="n">init_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
</span><span id="line-6"><span class="p">)</span>
</span><span id="line-7"><span class="n">settings</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>  <span class="c1"># Random difficulty configuration</span>
</span><span id="line-8"><span class="n">space</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># Resets to [2, 1, 5] (medium difficulty)</span>
</span></code></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Constraints are applied to the entire array, not individual elements.
Use a constraint function that validates the complete state.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#MultiDiscrete.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete.__init__" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.MultiDiscrete.__init__'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Initialize a MultiDiscrete space with state tracking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> â€“ Positional arguments passed to gymnasium.spaces.MultiDiscrete.</p></li>
<li><p><strong>init_value</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) â€“ Initial values for the space.
Must match the shape defined by nvec. Defaults to None.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) â€“ Function that takes a numpy array
and returns True if the values satisfy custom constraints.
Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> â€“ Keyword arguments passed to gymnasium.spaces.MultiDiscrete.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#MultiDiscrete.check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete.check" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.MultiDiscrete.check'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Validate the current space values.</p>
<p>Checks if the current values are within the space bounds and satisfy
the constraint function. Logs a warning if the constraint fails.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the current values are valid, False otherwise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete.contains">
<span class="sig-name descname"><span class="pre">contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#MultiDiscrete.contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete.contains" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.MultiDiscrete.contains'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Check if values are valid and satisfy constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) â€“ The array of values to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>True if x is within bounds for all elements and satisfies</dt><dd><p>the constraint function, False otherwise.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete.init_value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete.init_value" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.MultiDiscrete.init_value'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>The initial values of the space, returned by reset().</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#MultiDiscrete.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete.reset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.MultiDiscrete.reset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Reset the space values to their initial values.</p>
<p>Sets the current values back to the init_value specified during
initialization.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn_after_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#MultiDiscrete.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete.sample" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.MultiDiscrete.sample'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Sample random values using rejection sampling for constraints.</p>
<p>Repeatedly samples value arrays until one satisfies the constraint
function or max_tries is reached. Optionally updates the spaceâ€™s
current values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> â€“ Positional arguments passed to gymnasium.spaces.MultiDiscrete.sample().</p></li>
<li><p><strong>max_tries</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Maximum number of sampling attempts before
raising an error. Defaults to 1000.</p></li>
<li><p><strong>warn_after_s</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Time threshold in seconds after which
to log a warning about slow sampling. Set to None to disable.
Defaults to 5.0.</p></li>
<li><p><strong>set_value</strong> (<em>bool</em><em>, </em><em>optional</em>) â€“ Whether to update the spaceâ€™s current
values with the sampled values. Defaults to True.</p></li>
<li><p><strong>**kwargs</strong> â€“ Keyword arguments passed to gymnasium.spaces.MultiDiscrete.sample().</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sampled array that satisfies the constraint function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> â€“ If no valid sample is found after max_tries attempts.</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete.value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete.value" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.MultiDiscrete.value'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>The current values of the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.RGBBox">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RGBBox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/spaces/#RGBBox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.RGBBox" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.spaces.RGBBox'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <a class="reference internal" href="#stable_worldmodel.spaces.Box" title="stable_worldmodel.spaces.Box"><code class="xref py py-class docutils literal notranslate"><span class="pre">Box</span></code></a></p>
<p>Specialized box space for RGB image data with automatic constraints.</p>
<p>This class extends <code class="docutils literal notranslate"><span class="pre">Box</span></code> to provide a convenient space for RGB images,
automatically enforcing uint8 dtype and [0, 255] value ranges. It validates
that the shape includes exactly 3 channels for RGB data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>) â€“ Shape of the image. Must include a dimension of size 3
for the RGB channels. Common formats: (H, W, 3) or (3, H, W).</p></li>
<li><p><strong>init_value</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) â€“ Initial RGB image. Must match shape
and be uint8 dtype.</p></li>
<li><p><strong>*args</strong> â€“ Additional positional arguments passed to Box.</p></li>
<li><p><strong>**kwargs</strong> â€“ Additional keyword arguments passed to Box.</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>init_value</strong> (<em>np.ndarray</em>) â€“ The initial RGB image.</p></li>
<li><p><strong>value</strong> (<em>np.ndarray</em>) â€“ The current RGB image.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Create a space for 64x64 RGB images:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="line-2">
</span><span id="line-3"><span class="n">space</span> <span class="o">=</span> <span class="n">RGBBox</span><span class="p">(</span>
</span><span id="line-4">    <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">init_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span><span id="line-5"><span class="p">)</span>
</span><span id="line-6"><span class="n">image</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>  <span class="c1"># Random RGB image</span>
</span><span id="line-7"><span class="n">space</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># Returns to black image</span>
</span></code></pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AssertionError</strong> â€“ If shape does not contain a dimension of size 3.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This space is useful for vision-based environments where images
need to be sampled or tracked as part of environment configuration.
The low, high, and dtype parameters are automatically set and cannot
be overridden.</p>
</div>
</dd></dl>
</section>
<section id="module-stable_worldmodel.utils">
<span id="stable-worldmodel-utils-module"></span><h2>stable_worldmodel.utils module<a class="headerlink" href="#module-stable_worldmodel.utils" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#module-stable_worldmodel.utils'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>Utility functions for stable_worldmodel.</p>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.utils.flatten_dict">
<span class="sig-name descname"><span class="pre">flatten_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/utils/#flatten_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.utils.flatten_dict" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.utils.flatten_dict'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Flatten a nested dictionary into a single-level dictionary with concatenated keys.</p>
<p>The naming convention for the new keys is similar to Hydraâ€™s, using a <cite>.</cite> separator to denote levels of nesting.
Attention is needed when flattening dictionaries with overlapping keys, as this may lead to information loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>dict</em>) â€“ The nested dictionary to flatten.</p></li>
<li><p><strong>parent_key</strong> (<em>str</em><em>, </em><em>optional</em>) â€“ The base key to use for the flattened keys.</p></li>
<li><p><strong>sep</strong> (<em>str</em><em>, </em><em>optional</em>) â€“ The separator to use between levels of nesting. Defaults to â€˜.â€™.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A flattened version of the input dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"a"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"b"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"c"</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">:</span> <span class="mi">43</span><span class="p">}},</span> <span class="s2">"e"</span><span class="p">:</span> <span class="mi">44</span><span class="p">}</span>
</span><span id="line-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">flatten_dict</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</span><span id="line-3"><span class="go">{'a.b.c': 42, 'a.b.d': 43, 'e': 44}</span>
</span></code></pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">flatten_dict</span><span class="p">({</span><span class="s2">"a"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"b"</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="s2">"a.b"</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</span><span id="line-2"><span class="go">{'a.b': 3}</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.utils.get_in">
<span class="sig-name descname"><span class="pre">get_in</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/stable_worldmodel/utils/#get_in"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.utils.get_in" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.utils.get_in'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Retrieve a value from a nested dictionary using a sequence of keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mapping</strong> (<em>dict</em>) â€“ A nested dictionary.</p></li>
<li><p><strong>path</strong> (<em>Iterable</em><em>[</em><em>str</em><em>]</em>) â€“ An iterable of keys representing the path to the desired value in mapping.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value located at the specified path in the nested dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> â€“ If any key in the path does not exist in the mapping dict.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="gp">&gt;&gt;&gt; </span><span class="n">variations</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"a"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"b"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"c"</span><span class="p">:</span> <span class="mi">42</span><span class="p">}}}</span>
</span><span id="line-2"><span class="gp">&gt;&gt;&gt; </span><span class="n">get_in</span><span class="p">(</span><span class="n">variations</span><span class="p">,</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">])</span>
</span><span id="line-3"><span class="go">42</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.utils.pretraining">
<span class="sig-name descname"><span class="pre">pretraining</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">script_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/stable_worldmodel/utils/#pretraining"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.utils.pretraining" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.utils.pretraining'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Run a pretraining script as a subprocess with optional command-line arguments.</p>
<p>This function checks if the specified script exists, constructs a command to run it with the provided arguments,
and executes the command in a subprocess.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>script_path</strong> (<em>str</em>) â€“ The path to the pretraining script to be executed.</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em>) â€“ The name of the dataset to be used in pretraining.</p></li>
<li><p><strong>output_model_name</strong> (<em>str</em>) â€“ The name to save the output model.</p></li>
<li><p><strong>dump_object</strong> (<em>bool</em><em>, </em><em>optional</em>) â€“ Whether to dump the model object after training. Defaults to</p></li>
<li><p><strong>args</strong> (<em>str</em><em>, </em><em>optional</em>) â€“ A string of command-line arguments to pass to the script. Defaults to an empty string.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The return code of the subprocess. A return code of 0 indicates success.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> â€“ If the specified script does not exist.</p></li>
<li><p><strong>SystemExit</strong> â€“ If the subprocess exits with a non-zero return code.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-stable_worldmodel.world">
<span id="stable-worldmodel-world-module"></span><h2>stable_worldmodel.world module<a class="headerlink" href="#module-stable_worldmodel.world" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#module-stable_worldmodel.world'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>World environment manager.</p>
<p>This module provides the World class, a high-level manager for vectorized Gymnasium
environments with integrated support for data collection, policy evaluation, video
recording, and dataset management. It serves as the central orchestration layer for
training and evaluating world models with domain randomization support.</p>
<dl class="simple">
<dt>The World class handles:</dt><dd><ul class="simple">
<li><p>Vectorized environment creation and management</p></li>
<li><p>Policy attachment and execution</p></li>
<li><p>Episode data collection with automatic sharding</p></li>
<li><p>Video recording from live rollouts or stored datasets</p></li>
<li><p>Policy evaluation with comprehensive metrics</p></li>
<li><p>Visual domain randomization through variation spaces</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Basic usage for policy evaluation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="kn">from</span><span class="w"> </span><span class="nn">stable_worldmodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">World</span>
</span><span id="line-2"><span class="kn">from</span><span class="w"> </span><span class="nn">stable_worldmodel.policy</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomPolicy</span>
</span><span id="line-3">
</span><span id="line-4"><span class="c1"># Create a world with 4 parallel environments</span>
</span><span id="line-5"><span class="n">world</span> <span class="o">=</span> <span class="n">World</span><span class="p">(</span>
</span><span id="line-6">    <span class="n">env_name</span><span class="o">=</span><span class="s2">"PushT-v1"</span><span class="p">,</span>
</span><span id="line-7">    <span class="n">num_envs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
</span><span id="line-8">    <span class="n">image_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">96</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span>
</span><span id="line-9">    <span class="n">max_episode_steps</span><span class="o">=</span><span class="mi">200</span>
</span><span id="line-10"><span class="p">)</span>
</span><span id="line-11">
</span><span id="line-12"><span class="c1"># Attach a policy</span>
</span><span id="line-13"><span class="n">policy</span> <span class="o">=</span> <span class="n">RandomPolicy</span><span class="p">()</span>
</span><span id="line-14"><span class="n">world</span><span class="o">.</span><span class="n">set_policy</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span>
</span><span id="line-15">
</span><span id="line-16"><span class="c1"># Evaluate the policy</span>
</span><span id="line-17"><span class="n">metrics</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">episodes</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="line-18"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Success rate: </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s1">'success_rate'</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%"</span><span class="p">)</span>
</span></code></pre></div>
</div>
<p>Data collection example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="c1"># Collect demonstration data</span>
</span><span id="line-2"><span class="n">world</span><span class="o">.</span><span class="n">record_dataset</span><span class="p">(</span>
</span><span id="line-3">    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">"pusht_demos"</span><span class="p">,</span>
</span><span id="line-4">    <span class="n">episodes</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
</span><span id="line-5">    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="line-6">    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">'variation'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'all'</span><span class="p">]}</span>
</span><span id="line-7"><span class="p">)</span>
</span></code></pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.world.World">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">World</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_envs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2349867</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_episode_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>High-level manager for vectorized Gymnasium environments with integrated data collection.</p>
<p>World orchestrates multiple parallel environments, providing a unified interface for
policy execution, data collection, evaluation, and visualization. It automatically
handles environment resets, batched action execution, and comprehensive episode
tracking with support for visual domain randomization.</p>
<p>The World class is the central component of the stable-worldmodel library, designed
to streamline the workflow from data collection to policy training and evaluation.
It wraps Gymnasiumâ€™s vectorized environments with additional functionality for
world model research.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>envs</strong> (<em>VectorEnv</em>) â€“ Vectorized Gymnasium environment wrapped with MegaWrapper
and VariationWrapper for image processing and domain randomization.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) â€“ Base random seed for reproducibility.</p></li>
<li><p><strong>policy</strong> (<em>Policy</em>) â€“ Currently attached policy that generates actions.</p></li>
<li><p><strong>states</strong> (<em>ndarray</em>) â€“ Current observation states for all environments.</p></li>
<li><p><strong>rewards</strong> (<em>ndarray</em>) â€“ Current rewards for all environments.</p></li>
<li><p><strong>terminateds</strong> (<em>ndarray</em>) â€“ Terminal flags indicating episode completion.</p></li>
<li><p><strong>truncateds</strong> (<em>ndarray</em>) â€“ Truncation flags indicating episode timeout.</p></li>
<li><p><strong>infos</strong> (<em>dict</em>) â€“ Dictionary containing major information from environments.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Properties:</dt><dd><p>num_envs (int): Number of parallel environments.
observation_space (Space): Batched observation space.
action_space (Space): Batched action space.
variation_space (Dict): Variation space for domain randomization (batched).
single_variation_space (Dict): Variation space for a single environment.
single_action_space (Space): Action space for a single environment.
single_observation_space (Space): Observation space for a single environment.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Environments use DISABLED autoreset mode to enable custom reset behavior
with seed and options support, which is not provided by Gymnasiumâ€™s default
autoreset mechanism.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_envs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2349867</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_episode_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.__init__" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.__init__'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Initialize the World with vectorized environments.</p>
<p>Creates and configures a vectorized environment with the specified number of
parallel instances. Applies image and goal transformations, sets up variation
support, and configures autoreset behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_name</strong> (<em>str</em>) â€“ Name of the Gymnasium environment to create. Must be a
registered environment ID (e.g., â€˜PushT-v0â€™, â€˜CubeEnv-v0â€™).</p></li>
<li><p><strong>num_envs</strong> (<em>int</em>) â€“ Number of parallel environment instances to create.
Higher values increase data collection throughput but require more memory.</p></li>
<li><p><strong>image_shape</strong> (<em>tuple</em>) â€“ Target shape for image observations as (height, width)
or (height, width, channels). Images are resized to this shape.</p></li>
<li><p><strong>goal_shape</strong> (<em>tuple</em><em>, </em><em>optional</em>) â€“ Target shape for goal image observations.
If None, goals are processed with the same shape as observations.
Defaults to None.</p></li>
<li><p><strong>goal_transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) â€“ Function to transform goal observations.
Should accept and return numpy arrays. Applied after resizing.
Defaults to None.</p></li>
<li><p><strong>image_transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) â€“ Function to transform image observations.
Should accept and return numpy arrays. Applied after resizing.
Defaults to None.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Base random seed for environment initialization.
Each environment gets an offset seed. Defaults to 2349867.</p></li>
<li><p><strong>max_episode_steps</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Maximum number of steps per episode
before truncation. Episodes terminate early on task success.
Defaults to 100.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Verbosity level. 0 for silent, 1 for basic info,
2+ for detailed debugging information. Defaults to 1.</p></li>
<li><p><strong>**kwargs</strong> â€“ Additional keyword arguments passed to gym.make_vec() and
subsequently to the underlying environment constructor.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The MegaWrapper applies image transformations and resizing.
The VariationWrapper enables domain randomization support.
Autoreset is disabled to allow custom reset with seeds and options.</p>
</div>
<p class="rubric">Example</p>
<p>Create a world with goal-conditioned observations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span> <span class="o">=</span> <span class="n">World</span><span class="p">(</span>
</span><span id="line-2">    <span class="n">env_name</span><span class="o">=</span><span class="s2">"PushT-v1"</span><span class="p">,</span>
</span><span id="line-3">    <span class="n">num_envs</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
</span><span id="line-4">    <span class="n">image_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">96</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span>
</span><span id="line-5">    <span class="n">goal_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
</span><span id="line-6">    <span class="n">max_episode_steps</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
</span><span id="line-7">    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>
</span><span id="line-8"><span class="p">)</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.action_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#stable_worldmodel.world.World.action_space" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.action_space'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Batched action space for all environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Space</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.close" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.close'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Close all environments and clean up resources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> â€“ Additional keyword arguments passed to the underlying
vectorized environmentâ€™s close method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return value from the underlying close method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.evaluate" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.evaluate'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Evaluate the current policy over multiple episodes and return comprehensive metrics.</p>
<p>Runs the attached policy for a specified number of episodes, tracking success
rates and optionally other metrics from environment info. Handles episode
boundaries and ensures reproducibility through seeding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>episodes</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Total number of episodes to evaluate. More
episodes provide more statistically reliable metrics. Defaults to 10.</p></li>
<li><p><strong>eval_keys</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) â€“ Additional info keys to track across
episodes. Must be keys present in self.infos (e.g., â€˜reward_totalâ€™,
â€˜steps_to_successâ€™). Defaults to None (track only success rate).</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Base random seed for reproducible evaluation. Each
episode gets an incremental offset. Defaults to None (non-deterministic).</p></li>
<li><p><strong>options</strong> (<em>dict</em><em>, </em><em>optional</em>) â€“ Reset options passed to environments (e.g.,
task selection, variation settings). Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Dictionary containing evaluation metrics:</dt><dd><ul class="simple">
<li><p>â€™success_rateâ€™ (float): Percentage of successful episodes (0-100)</p></li>
<li><p>â€™episode_successesâ€™ (ndarray): Boolean array of episode outcomes</p></li>
<li><p>â€™seedsâ€™ (ndarray): Random seeds used for each episode</p></li>
<li><p>Additional keys from eval_keys if specified (ndarray)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> â€“ If eval_key is not found in infos, if episode count
    mismatch occurs, or if duplicate seeds are detected.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Success is determined by the â€˜terminatedsâ€™ flag (True = success)</p></li>
<li><p>â€˜truncatedsâ€™ flag (timeout) is treated as failure</p></li>
<li><p>Seeds are validated for uniqueness to ensure independent episodes</p></li>
<li><p>Environments are manually reset with seeds (autoreset is bypassed)</p></li>
<li><p>All environments are evaluated in parallel for efficiency</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<p>Basic evaluation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">metrics</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">episodes</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="line-2"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Success: </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s1">'success_rate'</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%"</span><span class="p">)</span>
</span></code></pre></div>
</div>
<p>Evaluate with additional metrics:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">metrics</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
</span><span id="line-2">    <span class="n">episodes</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="line-3">    <span class="n">eval_keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'reward_total'</span><span class="p">,</span> <span class="s1">'episode_length'</span><span class="p">],</span>
</span><span id="line-4">    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="line-5">    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">'task_id'</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
</span><span id="line-6"><span class="p">)</span>
</span><span id="line-7"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Success: </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s1">'success_rate'</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%"</span><span class="p">)</span>
</span><span id="line-8"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Avg reward: </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s1">'reward_total'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</span></code></pre></div>
</div>
<p>Evaluate across different variations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="k">for</span> <span class="n">var_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'none'</span><span class="p">,</span> <span class="s1">'color'</span><span class="p">,</span> <span class="s1">'light'</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">]:</span>
</span><span id="line-2">    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'variation'</span><span class="p">:</span> <span class="p">[</span><span class="n">var_type</span><span class="p">]}</span> <span class="k">if</span> <span class="n">var_type</span> <span class="o">!=</span> <span class="s1">'none'</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="line-3">    <span class="n">metrics</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">episodes</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</span><span id="line-4">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">var_type</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s1">'success_rate'</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%"</span><span class="p">)</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.num_envs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_envs</span></span><a class="headerlink" href="#stable_worldmodel.world.World.num_envs" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.num_envs'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Number of parallel environment instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.observation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#stable_worldmodel.world.World.observation_space" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.observation_space'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Batched observation space for all environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Space</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.record_dataset">
<span class="sig-name descname"><span class="pre">record_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.record_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.record_dataset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.record_dataset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Collect episodes with the current policy and save as a HuggingFace Dataset.</p>
<p>Executes the attached policy to collect demonstration or rollout data,
automatically managing episode boundaries and saving all observations, actions,
rewards, and auxiliary information as a sharded Parquet dataset. Images are
stored as JPEG files with paths in the dataset.</p>
<dl class="simple">
<dt>The dataset is organized with the following structure:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>dataset_name/</dt><dd><ul>
<li><dl class="simple">
<dt>img/</dt><dd><ul>
<li><dl class="simple">
<dt>{episode_idx}/</dt><dd><ul>
<li><p>{step_idx}_{column_name}.jpeg</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><p>data-{shard}.arrow (Parquet shards)</p></li>
<li><p>dataset_info.json</p></li>
<li><p>state.json</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_name</strong> (<em>str</em>) â€“ Name of the dataset. Used as subdirectory name in
cache_dir. Should be descriptive (e.g., â€˜pusht_expert_demosâ€™).</p></li>
<li><p><strong>episodes</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Total number of complete episodes to collect.
Incomplete episodes at the end are discarded. Defaults to 10.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Base random seed for reproducibility. Each episode
gets an incremental offset. Defaults to None (non-deterministic).</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) â€“ Root directory for dataset storage.
If None, uses swm.data.get_cache_dir(). Defaults to None.</p></li>
<li><p><strong>options</strong> (<em>dict</em><em>, </em><em>optional</em>) â€“ Reset options for environments. Use
{â€˜variationâ€™: [â€˜allâ€™]} for full domain randomization. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Dataset Schema:</dt><dd><dl class="simple">
<dt>Each row contains:</dt><dd><ul class="simple">
<li><p>episode_idx (int32): Episode identifier</p></li>
<li><p>step_idx (int32): Step within episode (0-indexed)</p></li>
<li><p>episode_len (int32): Total length of the episode</p></li>
<li><p>policy (string): Policy type identifier</p></li>
<li><p>pixels (string): Relative path to observation image</p></li>
<li><p>goal (string, optional): Relative path to goal image</p></li>
<li><p>action (float array): Action taken at this step</p></li>
<li><p>reward (float): Reward received</p></li>
<li><p>Additional keys from environment infos</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Actions are shifted: action at step t leads to observation at step t+1</p></li>
<li><p>Last action in each episode is NaN (no action leads from final state)</p></li>
<li><p>Images are saved as JPEG for efficiency (may introduce compression artifacts)</p></li>
<li><p>Dataset is automatically sharded: 1 shard per 50 episodes</p></li>
<li><p>Only complete episodes are included in the final dataset</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AssertionError</strong> â€“ If required keys (â€˜pixelsâ€™, â€˜episode_idxâ€™, â€˜step_idxâ€™,
    â€˜episode_lenâ€™) are missing from recorded data.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Collect demonstration data with variations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span><span class="o">.</span><span class="n">set_policy</span><span class="p">(</span><span class="n">expert_policy</span><span class="p">)</span>
</span><span id="line-2"><span class="n">world</span><span class="o">.</span><span class="n">record_dataset</span><span class="p">(</span>
</span><span id="line-3">    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">"cube_expert_1k"</span><span class="p">,</span>
</span><span id="line-4">    <span class="n">episodes</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
</span><span id="line-5">    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="line-6">    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">'variation'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'all'</span><span class="p">]}</span>
</span><span id="line-7"><span class="p">)</span>
</span></code></pre></div>
</div>
<p>Collect data for specific tasks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span><span class="o">.</span><span class="n">record_dataset</span><span class="p">(</span>
</span><span id="line-2">    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">"pusht_task2_data"</span><span class="p">,</span>
</span><span id="line-3">    <span class="n">episodes</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
</span><span id="line-4">    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">'task_id'</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</span><span id="line-5"><span class="p">)</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.record_video">
<span class="sig-name descname"><span class="pre">record_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viewname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pixels'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.record_video"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.record_video" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.record_video'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Record rollout videos for each environment under the current policy.</p>
<p>Executes policy rollouts in all environments and saves them as MP4 videos,
one per environment. Videos show stacked observation and goal images when
goals are available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>video_path</strong> (<em>str</em><em> or </em><em>Path</em>) â€“ Directory path where videos will be saved.
Created if it doesnâ€™t exist. Videos are named â€˜env_0.mp4â€™, â€˜env_1.mp4â€™, etc.</p></li>
<li><p><strong>max_steps</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Maximum number of steps to record per episode.
Recording stops earlier if any environment terminates. Defaults to 500.</p></li>
<li><p><strong>fps</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Frames per second for output videos. Higher values
produce smoother playback but larger files. Defaults to 30.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Random seed for reproducible rollouts. Defaults to None.</p></li>
<li><p><strong>options</strong> (<em>dict</em><em>, </em><em>optional</em>) â€“ Reset options passed to environments (e.g.,
variation settings). Defaults to None.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Videos use libx264 codec for compatibility</p></li>
<li><p>If â€˜goalâ€™ is present in infos, frames show observation stacked above goal</p></li>
<li><p>All environments are recorded simultaneously</p></li>
<li><p>Recording stops when ANY environment terminates or truncates</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<p>Record evaluation videos:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span><span class="o">.</span><span class="n">set_policy</span><span class="p">(</span><span class="n">trained_policy</span><span class="p">)</span>
</span><span id="line-2"><span class="n">world</span><span class="o">.</span><span class="n">record_video</span><span class="p">(</span>
</span><span id="line-3">    <span class="n">video_path</span><span class="o">=</span><span class="s2">"./eval_videos"</span><span class="p">,</span>
</span><span id="line-4">    <span class="n">max_steps</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
</span><span id="line-5">    <span class="n">fps</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="line-6">    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>
</span><span id="line-7"><span class="p">)</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.record_video_from_dataset">
<span class="sig-name descname"><span class="pre">record_video_from_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episode_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_proc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viewname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'pixels'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.record_video_from_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.record_video_from_dataset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.record_video_from_dataset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Replay stored dataset episodes and export them as MP4 videos.</p>
<p>Loads episodes from a previously recorded dataset and renders them as videos,
useful for visualization, debugging, and qualitative evaluation of collected data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>video_path</strong> (<em>str</em><em> or </em><em>Path</em>) â€“ Directory where videos will be saved. Videos are
named â€˜episode_{idx}.mp4â€™. Directory is created if it doesnâ€™t exist.</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em>) â€“ Name of the dataset to load (must exist in cache_dir).</p></li>
<li><p><strong>episode_idx</strong> (<em>int</em><em> or </em><em>list</em><em> of </em><em>int</em>) â€“ Episode index or list of episode indices
to render. Each episode is saved as a separate video file.</p></li>
<li><p><strong>max_steps</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Maximum number of steps to render per episode.
Useful for limiting video length. Defaults to 500.</p></li>
<li><p><strong>fps</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Frames per second for output videos. Defaults to 30.</p></li>
<li><p><strong>num_proc</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Number of processes for parallel dataset filtering.
Higher values speed up loading for large datasets. Defaults to 4.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) â€“ Root directory where dataset is stored.
If None, uses swm.data.get_cache_dir(). Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> â€“ If dataset doesnâ€™t exist in cache_dir, or if episode
    length inconsistencies are detected in the data.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Images are loaded from JPEG files stored in the dataset</p></li>
<li><p>If â€˜goalâ€™ column exists, observation and goal are stacked vertically</p></li>
<li><p>Videos use libx264 codec for broad compatibility</p></li>
<li><p>Episodes are validated for consistency (length matches metadata)</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<p>Render specific episodes from a dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span><span class="o">.</span><span class="n">record_video_from_dataset</span><span class="p">(</span>
</span><span id="line-2">    <span class="n">video_path</span><span class="o">=</span><span class="s2">"./visualizations"</span><span class="p">,</span>
</span><span id="line-3">    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">"cube_expert_1k"</span><span class="p">,</span>
</span><span id="line-4">    <span class="n">episode_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">],</span>
</span><span id="line-5">    <span class="n">fps</span><span class="o">=</span><span class="mi">30</span>
</span><span id="line-6"><span class="p">)</span>
</span></code></pre></div>
</div>
<p>Render a single episode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span><span class="o">.</span><span class="n">record_video_from_dataset</span><span class="p">(</span>
</span><span id="line-2">    <span class="n">video_path</span><span class="o">=</span><span class="s2">"./debug"</span><span class="p">,</span>
</span><span id="line-3">    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">"failed_episodes"</span><span class="p">,</span>
</span><span id="line-4">    <span class="n">episode_idx</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="line-5">    <span class="n">max_steps</span><span class="o">=</span><span class="mi">100</span>
</span><span id="line-6"><span class="p">)</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.reset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.reset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Reset all environments to initial states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Random seed for reproducible resets. If None,
uses non-deterministic seeding. Defaults to None.</p></li>
<li><p><strong>options</strong> (<em>dict</em><em>, </em><em>optional</em>) â€“ Dictionary of reset options passed to
environments. Common keys include â€˜variationâ€™ for domain
randomization. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Updates:</dt><dd><ul class="simple">
<li><p>self.states: Initial observations from all environments</p></li>
<li><p>self.infos: Initial auxiliary information</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Reset with domain randomization:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">'variation'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'all'</span><span class="p">]})</span>
</span></code></pre></div>
</div>
<p>Reset specific variations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">'variation'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'cube.color'</span><span class="p">,</span> <span class="s1">'light.intensity'</span><span class="p">]})</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.set_policy">
<span class="sig-name descname"><span class="pre">set_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.set_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.set_policy" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.set_policy'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Attach a policy to the world and configure it with environment context.</p>
<p>The policy will be used for action generation during step(), record_video(),
record_dataset(), and evaluate() calls.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>policy</strong> (<em>Policy</em>) â€“ Policy instance that implements get_action(infos) method.
The policy receives environment context through set_env() and optional
seeding through set_seed().</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the policy has a â€˜seedâ€™ attribute, it will be applied via set_seed().
The policyâ€™s set_env() method receives the wrapped vectorized environment.</p>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.single_action_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">single_action_space</span></span><a class="headerlink" href="#stable_worldmodel.world.World.single_action_space" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.single_action_space'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Action space for a single environment instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Space</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.single_observation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">single_observation_space</span></span><a class="headerlink" href="#stable_worldmodel.world.World.single_observation_space" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.single_observation_space'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Observation space for a single environment instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Space</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.single_variation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">single_variation_space</span></span><a class="headerlink" href="#stable_worldmodel.world.World.single_variation_space" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.single_variation_space'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Variation space for a single environment instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stable_worldmodel.spaces.Dict" title="stable_worldmodel.spaces.Dict">Dict</a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.step" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.step'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Advance all environments by one step using the current policy.</p>
<p>Queries the attached policy for actions based on current info, executes
those actions in all environments, and updates internal state with the
results.</p>
<dl class="simple">
<dt>Updates:</dt><dd><ul class="simple">
<li><p>self.states: New observations from all environments</p></li>
<li><p>self.rewards: Rewards received from the step</p></li>
<li><p>self.terminateds: Episode termination flags (task success)</p></li>
<li><p>self.truncateds: Episode truncation flags (timeout)</p></li>
<li><p>self.infos: Auxiliary information dictionaries</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires a policy to be attached via set_policy() before calling.
The policyâ€™s get_action() method receives the current infos dict.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AttributeError</strong> â€“ If no policy has been set via set_policy().</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.variation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variation_space</span></span><a class="headerlink" href="#stable_worldmodel.world.World.variation_space" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.world.World.variation_space'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Batched variation space for domain randomization across all environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stable_worldmodel.spaces.Dict" title="stable_worldmodel.spaces.Dict">Dict</a></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="module-stable_worldmodel.wrappers">
<span id="stable-worldmodel-wrappers-module"></span><h2>stable_worldmodel.wrappers module<a class="headerlink" href="#module-stable_worldmodel.wrappers" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#module-stable_worldmodel.wrappers'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.AddPixelsWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AddPixelsWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixels_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(84,</span> <span class="pre">84)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torchvision_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#AddPixelsWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.AddPixelsWrapper" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.AddPixelsWrapper'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code></p>
<p>Adds rendered environment pixels to info dict with optional resizing and transforms.</p>
<p>Supports single images, dictionaries of images (multiview), or lists of images.
Uses PIL for resizing and optional torchvision transforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> â€“ The Gymnasium environment to wrap.</p></li>
<li><p><strong>pixels_shape</strong> â€“ Target (height, width) for resized images. Defaults to (84, 84).</p></li>
<li><p><strong>torchvision_transform</strong> â€“ Optional transform to apply to PIL images.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Info Keys Added:</dt><dd><ul class="simple">
<li><p>pixels: Rendered image (single view).</p></li>
<li><p>pixels.{key}: Individual images (multiview dict).</p></li>
<li><p>pixels.{idx}: Individual images (multiview list).</p></li>
<li><p>render_time: Time taken to render in seconds.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.AddPixelsWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#AddPixelsWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.AddPixelsWrapper.reset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.AddPixelsWrapper.reset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.AddPixelsWrapper.reset" title="stable_worldmodel.wrappers.AddPixelsWrapper.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.AddPixelsWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#AddPixelsWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.AddPixelsWrapper.step" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.AddPixelsWrapper.step'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.AddPixelsWrapper.step" title="stable_worldmodel.wrappers.AddPixelsWrapper.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureGoalInfoWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EnsureGoalInfoWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#EnsureGoalInfoWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.EnsureGoalInfoWrapper'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code></p>
<p>Validates that â€˜goalâ€™ key is present in info dict during reset and/or step.</p>
<p>Useful for goal-conditioned environments to ensure goal information is provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> â€“ The Gymnasium environment to wrap.</p></li>
<li><p><strong>check_reset</strong> â€“ If True, validates â€˜goalâ€™ key is in info after reset().</p></li>
<li><p><strong>check_step</strong> â€“ If True, validates â€˜goalâ€™ key is in info after step().</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> â€“ If â€˜goalâ€™ key is missing when validation is enabled.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureGoalInfoWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#EnsureGoalInfoWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.reset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.reset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.reset" title="stable_worldmodel.wrappers.EnsureGoalInfoWrapper.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureGoalInfoWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#EnsureGoalInfoWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.step" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.step'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.step" title="stable_worldmodel.wrappers.EnsureGoalInfoWrapper.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureImageShape">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EnsureImageShape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#EnsureImageShape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureImageShape" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.EnsureImageShape'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code></p>
<p>Validates that an image in the info dict has the expected spatial dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> â€“ The Gymnasium environment to wrap.</p></li>
<li><p><strong>image_key</strong> â€“ Key in info dict containing the image to validate.</p></li>
<li><p><strong>image_shape</strong> â€“ Expected (height, width) tuple for the image.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> â€“ If the image shape doesnâ€™t match the expected dimensions.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureImageShape.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#EnsureImageShape.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureImageShape.reset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.EnsureImageShape.reset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EnsureImageShape.reset" title="stable_worldmodel.wrappers.EnsureImageShape.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureImageShape.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#EnsureImageShape.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureImageShape.step" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.EnsureImageShape.step'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EnsureImageShape.step" title="stable_worldmodel.wrappers.EnsureImageShape.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureInfoKeysWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EnsureInfoKeysWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#EnsureInfoKeysWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.EnsureInfoKeysWrapper'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code></p>
<p>Validates that required keys are present in the info dict after reset and step.</p>
<p>Supports regex patterns for flexible key matching. Raises RuntimeError if any
required pattern has no matching key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> â€“ The Gymnasium environment to wrap.</p></li>
<li><p><strong>required_keys</strong> â€“ Iterable of regex patterns as strings. Each pattern must match
at least one key in the info dict.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> â€“ If any required pattern has no matching key in info dict.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureInfoKeysWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#EnsureInfoKeysWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.reset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.reset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.reset" title="stable_worldmodel.wrappers.EnsureInfoKeysWrapper.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureInfoKeysWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#EnsureInfoKeysWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.step" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.step'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.step" title="stable_worldmodel.wrappers.EnsureInfoKeysWrapper.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EverythingToInfoWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EverythingToInfoWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#EverythingToInfoWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.EverythingToInfoWrapper'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code></p>
<p>Moves all transition information into the info dict for unified data access.</p>
<p>Adds observation, reward, terminated, truncated, action, and step_idx to info.
Optionally tracks environment variations when specified in reset options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>env</strong> â€“ The Gymnasium environment to wrap.</p>
</dd>
</dl>
<dl class="simple">
<dt>Info Keys Added:</dt><dd><ul class="simple">
<li><p>observation (or dict keys if obs is dict): Current observation.</p></li>
<li><p>reward: Reward value (NaN after reset).</p></li>
<li><p>terminated: Episode termination flag.</p></li>
<li><p>truncated: Episode truncation flag.</p></li>
<li><p>action: Action taken (NaN sample after reset).</p></li>
<li><p>step_idx: Current step counter.</p></li>
<li><p>variation.{key}: Variation values if requested via reset options.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pass options={â€œvariationâ€: [â€œkey1â€, â€œkey2â€]} or [â€œallâ€] to reset() to track variations.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EverythingToInfoWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#EverythingToInfoWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper.reset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.EverythingToInfoWrapper.reset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper.reset" title="stable_worldmodel.wrappers.EverythingToInfoWrapper.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EverythingToInfoWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#EverythingToInfoWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper.step" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.EverythingToInfoWrapper.step'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper.step" title="stable_worldmodel.wrappers.EverythingToInfoWrapper.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.MegaWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MegaWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(84,</span> <span class="pre">84)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixels_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separate_goal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#MegaWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.MegaWrapper" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.MegaWrapper'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code></p>
<p>Combines multiple wrappers for comprehensive environment preprocessing.</p>
<p>Applies in sequence: AddPixelsWrapper â†’ EverythingToInfoWrapper â†’
EnsureInfoKeysWrapper â†’ EnsureGoalInfoWrapper â†’ ResizeGoalWrapper.</p>
<p>This provides a complete preprocessing pipeline with rendered pixels, unified
info dict, key validation, goal checking, and goal resizing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> â€“ The Gymnasium environment to wrap.</p></li>
<li><p><strong>image_shape</strong> â€“ Target (height, width) for pixels and goal. Defaults to (84, 84).</p></li>
<li><p><strong>pixels_transform</strong> â€“ Optional torchvision transform for rendered pixels.</p></li>
<li><p><strong>goal_transform</strong> â€“ Optional torchvision transform for goal images.</p></li>
<li><p><strong>required_keys</strong> â€“ Additional regex patterns for keys that must be in info.
Pattern <code class="docutils literal notranslate"><span class="pre">^pixels(?:\..*)?$</span></code> is always added.</p></li>
<li><p><strong>separate_goal</strong> â€“ If True, validates â€˜goalâ€™ is present in info. Defaults to True.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.MegaWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#MegaWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.MegaWrapper.reset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.MegaWrapper.reset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.MegaWrapper.reset" title="stable_worldmodel.wrappers.MegaWrapper.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.MegaWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#MegaWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.MegaWrapper.step" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.MegaWrapper.step'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.MegaWrapper.step" title="stable_worldmodel.wrappers.MegaWrapper.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.ResizeGoalWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ResizeGoalWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixels_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(84,</span> <span class="pre">84)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torchvision_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#ResizeGoalWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.ResizeGoalWrapper" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.ResizeGoalWrapper'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code></p>
<p>Resizes goal images in info dict with optional transforms.</p>
<p>Applies PIL-based resizing and optional torchvision transforms to the â€˜goalâ€™
image in info dict during both reset and step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> â€“ The Gymnasium environment to wrap.</p></li>
<li><p><strong>pixels_shape</strong> â€“ Target (height, width) for resized goal images. Defaults to (84, 84).</p></li>
<li><p><strong>torchvision_transform</strong> â€“ Optional transform to apply to PIL goal images.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.ResizeGoalWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#ResizeGoalWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.ResizeGoalWrapper.reset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.ResizeGoalWrapper.reset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.ResizeGoalWrapper.reset" title="stable_worldmodel.wrappers.ResizeGoalWrapper.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.ResizeGoalWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#ResizeGoalWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.ResizeGoalWrapper.step" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.ResizeGoalWrapper.step'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.ResizeGoalWrapper.step" title="stable_worldmodel.wrappers.ResizeGoalWrapper.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.VariationWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">VariationWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variation_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Space</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'same'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/wrappers/#VariationWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.VariationWrapper" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.VariationWrapper'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">VectorWrapper</span></code></p>
<p>Manages variation spaces for vectorized environments.</p>
<p>Handles batching of variation spaces across multiple environments, supporting
either shared variations (same) or independent variations (different).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> â€“ The vectorized Gymnasium environment to wrap.</p></li>
<li><p><strong>variation_mode</strong> â€“ Mode for handling variations across environments:
- â€œsameâ€: All environments share the same variation space (batched).
- â€œdifferentâ€: Each environment has independent variation spaces.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> â€“ If variation_mode is invalid or sub-environment spaces donâ€™t match.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Base environment must have a <code class="docutils literal notranslate"><span class="pre">variation_space</span></code> attribute. If missing,
variation spaces are set to None.</p>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.VariationWrapper.envs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">envs</span></span><a class="headerlink" href="#stable_worldmodel.wrappers.VariationWrapper.envs" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.wrappers.VariationWrapper.envs'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
</dd></dl>
</section>
<section id="module-stable_worldmodel">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-stable_worldmodel" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#module-stable_worldmodel'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.PlanConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PlanConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">horizon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">receding_horizon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_block</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warm_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/policy/#PlanConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.PlanConfig" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.PlanConfig'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration for the planning process.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.PlanConfig.action_block">
<span class="sig-name descname"><span class="pre">action_block</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#stable_worldmodel.PlanConfig.action_block" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.PlanConfig.action_block'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.PlanConfig.history_len">
<span class="sig-name descname"><span class="pre">history_len</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#stable_worldmodel.PlanConfig.history_len" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.PlanConfig.history_len'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.PlanConfig.horizon">
<span class="sig-name descname"><span class="pre">horizon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#stable_worldmodel.PlanConfig.horizon" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.PlanConfig.horizon'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.PlanConfig.plan_len">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plan_len</span></span><a class="headerlink" href="#stable_worldmodel.PlanConfig.plan_len" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.PlanConfig.plan_len'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.PlanConfig.receding_horizon">
<span class="sig-name descname"><span class="pre">receding_horizon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#stable_worldmodel.PlanConfig.receding_horizon" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.PlanConfig.receding_horizon'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.PlanConfig.warm_start">
<span class="sig-name descname"><span class="pre">warm_start</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#stable_worldmodel.PlanConfig.warm_start" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.PlanConfig.warm_start'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.World">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">World</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_envs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2349867</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_episode_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>High-level manager for vectorized Gymnasium environments with integrated data collection.</p>
<p>World orchestrates multiple parallel environments, providing a unified interface for
policy execution, data collection, evaluation, and visualization. It automatically
handles environment resets, batched action execution, and comprehensive episode
tracking with support for visual domain randomization.</p>
<p>The World class is the central component of the stable-worldmodel library, designed
to streamline the workflow from data collection to policy training and evaluation.
It wraps Gymnasiumâ€™s vectorized environments with additional functionality for
world model research.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>envs</strong> (<em>VectorEnv</em>) â€“ Vectorized Gymnasium environment wrapped with MegaWrapper
and VariationWrapper for image processing and domain randomization.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) â€“ Base random seed for reproducibility.</p></li>
<li><p><strong>policy</strong> (<em>Policy</em>) â€“ Currently attached policy that generates actions.</p></li>
<li><p><strong>states</strong> (<em>ndarray</em>) â€“ Current observation states for all environments.</p></li>
<li><p><strong>rewards</strong> (<em>ndarray</em>) â€“ Current rewards for all environments.</p></li>
<li><p><strong>terminateds</strong> (<em>ndarray</em>) â€“ Terminal flags indicating episode completion.</p></li>
<li><p><strong>truncateds</strong> (<em>ndarray</em>) â€“ Truncation flags indicating episode timeout.</p></li>
<li><p><strong>infos</strong> (<em>dict</em>) â€“ Dictionary containing major information from environments.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Properties:</dt><dd><p>num_envs (int): Number of parallel environments.
observation_space (Space): Batched observation space.
action_space (Space): Batched action space.
variation_space (Dict): Variation space for domain randomization (batched).
single_variation_space (Dict): Variation space for a single environment.
single_action_space (Space): Action space for a single environment.
single_observation_space (Space): Observation space for a single environment.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Environments use DISABLED autoreset mode to enable custom reset behavior
with seed and options support, which is not provided by Gymnasiumâ€™s default
autoreset mechanism.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_envs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2349867</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_episode_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.__init__" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.__init__'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Initialize the World with vectorized environments.</p>
<p>Creates and configures a vectorized environment with the specified number of
parallel instances. Applies image and goal transformations, sets up variation
support, and configures autoreset behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_name</strong> (<em>str</em>) â€“ Name of the Gymnasium environment to create. Must be a
registered environment ID (e.g., â€˜PushT-v0â€™, â€˜CubeEnv-v0â€™).</p></li>
<li><p><strong>num_envs</strong> (<em>int</em>) â€“ Number of parallel environment instances to create.
Higher values increase data collection throughput but require more memory.</p></li>
<li><p><strong>image_shape</strong> (<em>tuple</em>) â€“ Target shape for image observations as (height, width)
or (height, width, channels). Images are resized to this shape.</p></li>
<li><p><strong>goal_shape</strong> (<em>tuple</em><em>, </em><em>optional</em>) â€“ Target shape for goal image observations.
If None, goals are processed with the same shape as observations.
Defaults to None.</p></li>
<li><p><strong>goal_transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) â€“ Function to transform goal observations.
Should accept and return numpy arrays. Applied after resizing.
Defaults to None.</p></li>
<li><p><strong>image_transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) â€“ Function to transform image observations.
Should accept and return numpy arrays. Applied after resizing.
Defaults to None.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Base random seed for environment initialization.
Each environment gets an offset seed. Defaults to 2349867.</p></li>
<li><p><strong>max_episode_steps</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Maximum number of steps per episode
before truncation. Episodes terminate early on task success.
Defaults to 100.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Verbosity level. 0 for silent, 1 for basic info,
2+ for detailed debugging information. Defaults to 1.</p></li>
<li><p><strong>**kwargs</strong> â€“ Additional keyword arguments passed to gym.make_vec() and
subsequently to the underlying environment constructor.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The MegaWrapper applies image transformations and resizing.
The VariationWrapper enables domain randomization support.
Autoreset is disabled to allow custom reset with seeds and options.</p>
</div>
<p class="rubric">Example</p>
<p>Create a world with goal-conditioned observations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span> <span class="o">=</span> <span class="n">World</span><span class="p">(</span>
</span><span id="line-2">    <span class="n">env_name</span><span class="o">=</span><span class="s2">"PushT-v1"</span><span class="p">,</span>
</span><span id="line-3">    <span class="n">num_envs</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
</span><span id="line-4">    <span class="n">image_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">96</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span>
</span><span id="line-5">    <span class="n">goal_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
</span><span id="line-6">    <span class="n">max_episode_steps</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
</span><span id="line-7">    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>
</span><span id="line-8"><span class="p">)</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.World.action_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#stable_worldmodel.World.action_space" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.action_space'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Batched action space for all environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Space</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.close" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.close'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Close all environments and clean up resources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> â€“ Additional keyword arguments passed to the underlying
vectorized environmentâ€™s close method.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return value from the underlying close method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.evaluate" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.evaluate'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Evaluate the current policy over multiple episodes and return comprehensive metrics.</p>
<p>Runs the attached policy for a specified number of episodes, tracking success
rates and optionally other metrics from environment info. Handles episode
boundaries and ensures reproducibility through seeding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>episodes</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Total number of episodes to evaluate. More
episodes provide more statistically reliable metrics. Defaults to 10.</p></li>
<li><p><strong>eval_keys</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) â€“ Additional info keys to track across
episodes. Must be keys present in self.infos (e.g., â€˜reward_totalâ€™,
â€˜steps_to_successâ€™). Defaults to None (track only success rate).</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Base random seed for reproducible evaluation. Each
episode gets an incremental offset. Defaults to None (non-deterministic).</p></li>
<li><p><strong>options</strong> (<em>dict</em><em>, </em><em>optional</em>) â€“ Reset options passed to environments (e.g.,
task selection, variation settings). Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Dictionary containing evaluation metrics:</dt><dd><ul class="simple">
<li><p>â€™success_rateâ€™ (float): Percentage of successful episodes (0-100)</p></li>
<li><p>â€™episode_successesâ€™ (ndarray): Boolean array of episode outcomes</p></li>
<li><p>â€™seedsâ€™ (ndarray): Random seeds used for each episode</p></li>
<li><p>Additional keys from eval_keys if specified (ndarray)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> â€“ If eval_key is not found in infos, if episode count
    mismatch occurs, or if duplicate seeds are detected.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Success is determined by the â€˜terminatedsâ€™ flag (True = success)</p></li>
<li><p>â€˜truncatedsâ€™ flag (timeout) is treated as failure</p></li>
<li><p>Seeds are validated for uniqueness to ensure independent episodes</p></li>
<li><p>Environments are manually reset with seeds (autoreset is bypassed)</p></li>
<li><p>All environments are evaluated in parallel for efficiency</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<p>Basic evaluation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">metrics</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">episodes</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="line-2"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Success: </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s1">'success_rate'</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%"</span><span class="p">)</span>
</span></code></pre></div>
</div>
<p>Evaluate with additional metrics:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">metrics</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
</span><span id="line-2">    <span class="n">episodes</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="line-3">    <span class="n">eval_keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'reward_total'</span><span class="p">,</span> <span class="s1">'episode_length'</span><span class="p">],</span>
</span><span id="line-4">    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="line-5">    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">'task_id'</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
</span><span id="line-6"><span class="p">)</span>
</span><span id="line-7"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Success: </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s1">'success_rate'</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%"</span><span class="p">)</span>
</span><span id="line-8"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Avg reward: </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s1">'reward_total'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</span></code></pre></div>
</div>
<p>Evaluate across different variations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="k">for</span> <span class="n">var_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'none'</span><span class="p">,</span> <span class="s1">'color'</span><span class="p">,</span> <span class="s1">'light'</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">]:</span>
</span><span id="line-2">    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'variation'</span><span class="p">:</span> <span class="p">[</span><span class="n">var_type</span><span class="p">]}</span> <span class="k">if</span> <span class="n">var_type</span> <span class="o">!=</span> <span class="s1">'none'</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="line-3">    <span class="n">metrics</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">episodes</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</span><span id="line-4">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">var_type</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s1">'success_rate'</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%"</span><span class="p">)</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.World.num_envs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_envs</span></span><a class="headerlink" href="#stable_worldmodel.World.num_envs" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.num_envs'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Number of parallel environment instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.World.observation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#stable_worldmodel.World.observation_space" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.observation_space'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Batched observation space for all environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Space</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.record_dataset">
<span class="sig-name descname"><span class="pre">record_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.record_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.record_dataset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.record_dataset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Collect episodes with the current policy and save as a HuggingFace Dataset.</p>
<p>Executes the attached policy to collect demonstration or rollout data,
automatically managing episode boundaries and saving all observations, actions,
rewards, and auxiliary information as a sharded Parquet dataset. Images are
stored as JPEG files with paths in the dataset.</p>
<dl class="simple">
<dt>The dataset is organized with the following structure:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>dataset_name/</dt><dd><ul>
<li><dl class="simple">
<dt>img/</dt><dd><ul>
<li><dl class="simple">
<dt>{episode_idx}/</dt><dd><ul>
<li><p>{step_idx}_{column_name}.jpeg</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><p>data-{shard}.arrow (Parquet shards)</p></li>
<li><p>dataset_info.json</p></li>
<li><p>state.json</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_name</strong> (<em>str</em>) â€“ Name of the dataset. Used as subdirectory name in
cache_dir. Should be descriptive (e.g., â€˜pusht_expert_demosâ€™).</p></li>
<li><p><strong>episodes</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Total number of complete episodes to collect.
Incomplete episodes at the end are discarded. Defaults to 10.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Base random seed for reproducibility. Each episode
gets an incremental offset. Defaults to None (non-deterministic).</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) â€“ Root directory for dataset storage.
If None, uses swm.data.get_cache_dir(). Defaults to None.</p></li>
<li><p><strong>options</strong> (<em>dict</em><em>, </em><em>optional</em>) â€“ Reset options for environments. Use
{â€˜variationâ€™: [â€˜allâ€™]} for full domain randomization. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Dataset Schema:</dt><dd><dl class="simple">
<dt>Each row contains:</dt><dd><ul class="simple">
<li><p>episode_idx (int32): Episode identifier</p></li>
<li><p>step_idx (int32): Step within episode (0-indexed)</p></li>
<li><p>episode_len (int32): Total length of the episode</p></li>
<li><p>policy (string): Policy type identifier</p></li>
<li><p>pixels (string): Relative path to observation image</p></li>
<li><p>goal (string, optional): Relative path to goal image</p></li>
<li><p>action (float array): Action taken at this step</p></li>
<li><p>reward (float): Reward received</p></li>
<li><p>Additional keys from environment infos</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Actions are shifted: action at step t leads to observation at step t+1</p></li>
<li><p>Last action in each episode is NaN (no action leads from final state)</p></li>
<li><p>Images are saved as JPEG for efficiency (may introduce compression artifacts)</p></li>
<li><p>Dataset is automatically sharded: 1 shard per 50 episodes</p></li>
<li><p>Only complete episodes are included in the final dataset</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AssertionError</strong> â€“ If required keys (â€˜pixelsâ€™, â€˜episode_idxâ€™, â€˜step_idxâ€™,
    â€˜episode_lenâ€™) are missing from recorded data.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Collect demonstration data with variations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span><span class="o">.</span><span class="n">set_policy</span><span class="p">(</span><span class="n">expert_policy</span><span class="p">)</span>
</span><span id="line-2"><span class="n">world</span><span class="o">.</span><span class="n">record_dataset</span><span class="p">(</span>
</span><span id="line-3">    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">"cube_expert_1k"</span><span class="p">,</span>
</span><span id="line-4">    <span class="n">episodes</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
</span><span id="line-5">    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="line-6">    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">'variation'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'all'</span><span class="p">]}</span>
</span><span id="line-7"><span class="p">)</span>
</span></code></pre></div>
</div>
<p>Collect data for specific tasks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span><span class="o">.</span><span class="n">record_dataset</span><span class="p">(</span>
</span><span id="line-2">    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">"pusht_task2_data"</span><span class="p">,</span>
</span><span id="line-3">    <span class="n">episodes</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
</span><span id="line-4">    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">'task_id'</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</span><span id="line-5"><span class="p">)</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.record_video">
<span class="sig-name descname"><span class="pre">record_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viewname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pixels'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.record_video"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.record_video" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.record_video'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Record rollout videos for each environment under the current policy.</p>
<p>Executes policy rollouts in all environments and saves them as MP4 videos,
one per environment. Videos show stacked observation and goal images when
goals are available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>video_path</strong> (<em>str</em><em> or </em><em>Path</em>) â€“ Directory path where videos will be saved.
Created if it doesnâ€™t exist. Videos are named â€˜env_0.mp4â€™, â€˜env_1.mp4â€™, etc.</p></li>
<li><p><strong>max_steps</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Maximum number of steps to record per episode.
Recording stops earlier if any environment terminates. Defaults to 500.</p></li>
<li><p><strong>fps</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Frames per second for output videos. Higher values
produce smoother playback but larger files. Defaults to 30.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Random seed for reproducible rollouts. Defaults to None.</p></li>
<li><p><strong>options</strong> (<em>dict</em><em>, </em><em>optional</em>) â€“ Reset options passed to environments (e.g.,
variation settings). Defaults to None.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Videos use libx264 codec for compatibility</p></li>
<li><p>If â€˜goalâ€™ is present in infos, frames show observation stacked above goal</p></li>
<li><p>All environments are recorded simultaneously</p></li>
<li><p>Recording stops when ANY environment terminates or truncates</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<p>Record evaluation videos:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span><span class="o">.</span><span class="n">set_policy</span><span class="p">(</span><span class="n">trained_policy</span><span class="p">)</span>
</span><span id="line-2"><span class="n">world</span><span class="o">.</span><span class="n">record_video</span><span class="p">(</span>
</span><span id="line-3">    <span class="n">video_path</span><span class="o">=</span><span class="s2">"./eval_videos"</span><span class="p">,</span>
</span><span id="line-4">    <span class="n">max_steps</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
</span><span id="line-5">    <span class="n">fps</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="line-6">    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>
</span><span id="line-7"><span class="p">)</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.record_video_from_dataset">
<span class="sig-name descname"><span class="pre">record_video_from_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episode_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_proc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viewname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'pixels'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.record_video_from_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.record_video_from_dataset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.record_video_from_dataset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Replay stored dataset episodes and export them as MP4 videos.</p>
<p>Loads episodes from a previously recorded dataset and renders them as videos,
useful for visualization, debugging, and qualitative evaluation of collected data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>video_path</strong> (<em>str</em><em> or </em><em>Path</em>) â€“ Directory where videos will be saved. Videos are
named â€˜episode_{idx}.mp4â€™. Directory is created if it doesnâ€™t exist.</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em>) â€“ Name of the dataset to load (must exist in cache_dir).</p></li>
<li><p><strong>episode_idx</strong> (<em>int</em><em> or </em><em>list</em><em> of </em><em>int</em>) â€“ Episode index or list of episode indices
to render. Each episode is saved as a separate video file.</p></li>
<li><p><strong>max_steps</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Maximum number of steps to render per episode.
Useful for limiting video length. Defaults to 500.</p></li>
<li><p><strong>fps</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Frames per second for output videos. Defaults to 30.</p></li>
<li><p><strong>num_proc</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Number of processes for parallel dataset filtering.
Higher values speed up loading for large datasets. Defaults to 4.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) â€“ Root directory where dataset is stored.
If None, uses swm.data.get_cache_dir(). Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> â€“ If dataset doesnâ€™t exist in cache_dir, or if episode
    length inconsistencies are detected in the data.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Images are loaded from JPEG files stored in the dataset</p></li>
<li><p>If â€˜goalâ€™ column exists, observation and goal are stacked vertically</p></li>
<li><p>Videos use libx264 codec for broad compatibility</p></li>
<li><p>Episodes are validated for consistency (length matches metadata)</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<p>Render specific episodes from a dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span><span class="o">.</span><span class="n">record_video_from_dataset</span><span class="p">(</span>
</span><span id="line-2">    <span class="n">video_path</span><span class="o">=</span><span class="s2">"./visualizations"</span><span class="p">,</span>
</span><span id="line-3">    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">"cube_expert_1k"</span><span class="p">,</span>
</span><span id="line-4">    <span class="n">episode_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">],</span>
</span><span id="line-5">    <span class="n">fps</span><span class="o">=</span><span class="mi">30</span>
</span><span id="line-6"><span class="p">)</span>
</span></code></pre></div>
</div>
<p>Render a single episode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span><span class="o">.</span><span class="n">record_video_from_dataset</span><span class="p">(</span>
</span><span id="line-2">    <span class="n">video_path</span><span class="o">=</span><span class="s2">"./debug"</span><span class="p">,</span>
</span><span id="line-3">    <span class="n">dataset_name</span><span class="o">=</span><span class="s2">"failed_episodes"</span><span class="p">,</span>
</span><span id="line-4">    <span class="n">episode_idx</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="line-5">    <span class="n">max_steps</span><span class="o">=</span><span class="mi">100</span>
</span><span id="line-6"><span class="p">)</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.reset" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.reset'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Reset all environments to initial states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Random seed for reproducible resets. If None,
uses non-deterministic seeding. Defaults to None.</p></li>
<li><p><strong>options</strong> (<em>dict</em><em>, </em><em>optional</em>) â€“ Dictionary of reset options passed to
environments. Common keys include â€˜variationâ€™ for domain
randomization. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Updates:</dt><dd><ul class="simple">
<li><p>self.states: Initial observations from all environments</p></li>
<li><p>self.infos: Initial auxiliary information</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Reset with domain randomization:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">'variation'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'all'</span><span class="p">]})</span>
</span></code></pre></div>
</div>
<p>Reset specific variations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">world</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">'variation'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'cube.color'</span><span class="p">,</span> <span class="s1">'light.intensity'</span><span class="p">]})</span>
</span></code></pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.set_policy">
<span class="sig-name descname"><span class="pre">set_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.set_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.set_policy" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.set_policy'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Attach a policy to the world and configure it with environment context.</p>
<p>The policy will be used for action generation during step(), record_video(),
record_dataset(), and evaluate() calls.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>policy</strong> (<em>Policy</em>) â€“ Policy instance that implements get_action(infos) method.
The policy receives environment context through set_env() and optional
seeding through set_seed().</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the policy has a â€˜seedâ€™ attribute, it will be applied via set_seed().
The policyâ€™s set_env() method receives the wrapped vectorized environment.</p>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.World.single_action_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">single_action_space</span></span><a class="headerlink" href="#stable_worldmodel.World.single_action_space" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.single_action_space'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Action space for a single environment instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Space</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.World.single_observation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">single_observation_space</span></span><a class="headerlink" href="#stable_worldmodel.World.single_observation_space" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.single_observation_space'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Observation space for a single environment instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Space</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.World.single_variation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">single_variation_space</span></span><a class="headerlink" href="#stable_worldmodel.World.single_variation_space" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.single_variation_space'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Variation space for a single environment instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stable_worldmodel.spaces.Dict" title="stable_worldmodel.spaces.Dict">Dict</a></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_worldmodel/world/#World.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.step" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.step'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Advance all environments by one step using the current policy.</p>
<p>Queries the attached policy for actions based on current info, executes
those actions in all environments, and updates internal state with the
results.</p>
<dl class="simple">
<dt>Updates:</dt><dd><ul class="simple">
<li><p>self.states: New observations from all environments</p></li>
<li><p>self.rewards: Rewards received from the step</p></li>
<li><p>self.terminateds: Episode termination flags (task success)</p></li>
<li><p>self.truncateds: Episode truncation flags (timeout)</p></li>
<li><p>self.infos: Auxiliary information dictionaries</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires a policy to be attached via set_policy() before calling.
The policyâ€™s get_action() method receives the current infos dict.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AttributeError</strong> â€“ If no policy has been set via set_policy().</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.World.variation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variation_space</span></span><a class="headerlink" href="#stable_worldmodel.World.variation_space" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.World.variation_space'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Batched variation space for domain randomization across all environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stable_worldmodel.spaces.Dict" title="stable_worldmodel.spaces.Dict">Dict</a></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.pretraining">
<span class="sig-name descname"><span class="pre">pretraining</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">script_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">â†’</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/stable_worldmodel/utils/#pretraining"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.pretraining" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#stable_worldmodel.pretraining'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></dt>
<dd><p>Run a pretraining script as a subprocess with optional command-line arguments.</p>
<p>This function checks if the specified script exists, constructs a command to run it with the provided arguments,
and executes the command in a subprocess.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>script_path</strong> (<em>str</em>) â€“ The path to the pretraining script to be executed.</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em>) â€“ The name of the dataset to be used in pretraining.</p></li>
<li><p><strong>output_model_name</strong> (<em>str</em>) â€“ The name to save the output model.</p></li>
<li><p><strong>dump_object</strong> (<em>bool</em><em>, </em><em>optional</em>) â€“ Whether to dump the model object after training. Defaults to</p></li>
<li><p><strong>args</strong> (<em>str</em><em>, </em><em>optional</em>) â€“ A string of command-line arguments to pass to the script. Defaults to an empty string.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The return code of the subprocess. A return code of 0 indicates success.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> â€“ If the specified script does not exist.</p></li>
<li><p><strong>SystemExit</strong> â€“ If the subprocess exits with a non-zero return code.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</section>
</section>
</div></div><aside class="hidden text-sm xl:block" id="right-sidebar">
<div class="sticky top-16 -mt-10 max-h-[calc(100vh-5rem)] overflow-y-auto pt-6 space-y-2"><p class="font-medium">On this page</p>
<ul>
<li><a :data-current="activeSection === '#subpackages'" class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a :data-current="activeSection === '#submodules'" class="reference internal" href="#submodules">Submodules</a></li>
<li><a :data-current="activeSection === '#module-stable_worldmodel.cli'" class="reference internal" href="#module-stable_worldmodel.cli">stable_worldmodel.cli module</a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.cli.common'" class="reference internal" href="#stable_worldmodel.cli.common"><code class="docutils literal notranslate"><span class="pre">common()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.cli.delete'" class="reference internal" href="#stable_worldmodel.cli.delete"><code class="docutils literal notranslate"><span class="pre">delete()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.cli.display_dataset_info'" class="reference internal" href="#stable_worldmodel.cli.display_dataset_info"><code class="docutils literal notranslate"><span class="pre">display_dataset_info()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.cli.display_world_info'" class="reference internal" href="#stable_worldmodel.cli.display_world_info"><code class="docutils literal notranslate"><span class="pre">display_world_info()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.cli.list_cmd'" class="reference internal" href="#stable_worldmodel.cli.list_cmd"><code class="docutils literal notranslate"><span class="pre">list_cmd()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.cli.show'" class="reference internal" href="#stable_worldmodel.cli.show"><code class="docutils literal notranslate"><span class="pre">show()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#module-stable_worldmodel.data'" class="reference internal" href="#module-stable_worldmodel.data">stable_worldmodel.data module</a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.data.SpaceInfo'" class="reference internal" href="#stable_worldmodel.data.SpaceInfo"><code class="docutils literal notranslate"><span class="pre">SpaceInfo</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.data.SpaceInfo.dtype'" class="reference internal" href="#stable_worldmodel.data.SpaceInfo.dtype"><code class="docutils literal notranslate"><span class="pre">SpaceInfo.dtype</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.SpaceInfo.high'" class="reference internal" href="#stable_worldmodel.data.SpaceInfo.high"><code class="docutils literal notranslate"><span class="pre">SpaceInfo.high</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.SpaceInfo.low'" class="reference internal" href="#stable_worldmodel.data.SpaceInfo.low"><code class="docutils literal notranslate"><span class="pre">SpaceInfo.low</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.SpaceInfo.n'" class="reference internal" href="#stable_worldmodel.data.SpaceInfo.n"><code class="docutils literal notranslate"><span class="pre">SpaceInfo.n</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.SpaceInfo.shape'" class="reference internal" href="#stable_worldmodel.data.SpaceInfo.shape"><code class="docutils literal notranslate"><span class="pre">SpaceInfo.shape</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.SpaceInfo.type'" class="reference internal" href="#stable_worldmodel.data.SpaceInfo.type"><code class="docutils literal notranslate"><span class="pre">SpaceInfo.type</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.StepsDataset'" class="reference internal" href="#stable_worldmodel.data.StepsDataset"><code class="docutils literal notranslate"><span class="pre">StepsDataset</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.data.StepsDataset.__init__'" class="reference internal" href="#stable_worldmodel.data.StepsDataset.__init__"><code class="docutils literal notranslate"><span class="pre">StepsDataset.__init__()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.StepsDataset.get_episode_slice'" class="reference internal" href="#stable_worldmodel.data.StepsDataset.get_episode_slice"><code class="docutils literal notranslate"><span class="pre">StepsDataset.get_episode_slice()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.StepsDataset.infer_img_path_columns'" class="reference internal" href="#stable_worldmodel.data.StepsDataset.infer_img_path_columns"><code class="docutils literal notranslate"><span class="pre">StepsDataset.infer_img_path_columns()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.VariationInfo'" class="reference internal" href="#stable_worldmodel.data.VariationInfo"><code class="docutils literal notranslate"><span class="pre">VariationInfo</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.data.VariationInfo.has_variation'" class="reference internal" href="#stable_worldmodel.data.VariationInfo.has_variation"><code class="docutils literal notranslate"><span class="pre">VariationInfo.has_variation</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.VariationInfo.names'" class="reference internal" href="#stable_worldmodel.data.VariationInfo.names"><code class="docutils literal notranslate"><span class="pre">VariationInfo.names</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.VariationInfo.type'" class="reference internal" href="#stable_worldmodel.data.VariationInfo.type"><code class="docutils literal notranslate"><span class="pre">VariationInfo.type</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.WorldInfo'" class="reference internal" href="#stable_worldmodel.data.WorldInfo"><code class="docutils literal notranslate"><span class="pre">WorldInfo</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.data.WorldInfo.action_space'" class="reference internal" href="#stable_worldmodel.data.WorldInfo.action_space"><code class="docutils literal notranslate"><span class="pre">WorldInfo.action_space</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.WorldInfo.config'" class="reference internal" href="#stable_worldmodel.data.WorldInfo.config"><code class="docutils literal notranslate"><span class="pre">WorldInfo.config</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.WorldInfo.name'" class="reference internal" href="#stable_worldmodel.data.WorldInfo.name"><code class="docutils literal notranslate"><span class="pre">WorldInfo.name</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.WorldInfo.observation_space'" class="reference internal" href="#stable_worldmodel.data.WorldInfo.observation_space"><code class="docutils literal notranslate"><span class="pre">WorldInfo.observation_space</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.WorldInfo.variation'" class="reference internal" href="#stable_worldmodel.data.WorldInfo.variation"><code class="docutils literal notranslate"><span class="pre">WorldInfo.variation</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.dataset_info'" class="reference internal" href="#stable_worldmodel.data.dataset_info"><code class="docutils literal notranslate"><span class="pre">dataset_info()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.delete_dataset'" class="reference internal" href="#stable_worldmodel.data.delete_dataset"><code class="docutils literal notranslate"><span class="pre">delete_dataset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.delete_model'" class="reference internal" href="#stable_worldmodel.data.delete_model"><code class="docutils literal notranslate"><span class="pre">delete_model()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.get_cache_dir'" class="reference internal" href="#stable_worldmodel.data.get_cache_dir"><code class="docutils literal notranslate"><span class="pre">get_cache_dir()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.is_image'" class="reference internal" href="#stable_worldmodel.data.is_image"><code class="docutils literal notranslate"><span class="pre">is_image()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.list_datasets'" class="reference internal" href="#stable_worldmodel.data.list_datasets"><code class="docutils literal notranslate"><span class="pre">list_datasets()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.list_models'" class="reference internal" href="#stable_worldmodel.data.list_models"><code class="docutils literal notranslate"><span class="pre">list_models()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.list_worlds'" class="reference internal" href="#stable_worldmodel.data.list_worlds"><code class="docutils literal notranslate"><span class="pre">list_worlds()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.data.world_info'" class="reference internal" href="#stable_worldmodel.data.world_info"><code class="docutils literal notranslate"><span class="pre">world_info()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#module-stable_worldmodel.policy'" class="reference internal" href="#module-stable_worldmodel.policy">stable_worldmodel.policy module</a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.AutoCostModel'" class="reference internal" href="#stable_worldmodel.policy.AutoCostModel"><code class="docutils literal notranslate"><span class="pre">AutoCostModel()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.BasePolicy'" class="reference internal" href="#stable_worldmodel.policy.BasePolicy"><code class="docutils literal notranslate"><span class="pre">BasePolicy</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.BasePolicy.get_action'" class="reference internal" href="#stable_worldmodel.policy.BasePolicy.get_action"><code class="docutils literal notranslate"><span class="pre">BasePolicy.get_action()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.BasePolicy.set_env'" class="reference internal" href="#stable_worldmodel.policy.BasePolicy.set_env"><code class="docutils literal notranslate"><span class="pre">BasePolicy.set_env()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.ExpertPolicy'" class="reference internal" href="#stable_worldmodel.policy.ExpertPolicy"><code class="docutils literal notranslate"><span class="pre">ExpertPolicy</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.ExpertPolicy.get_action'" class="reference internal" href="#stable_worldmodel.policy.ExpertPolicy.get_action"><code class="docutils literal notranslate"><span class="pre">ExpertPolicy.get_action()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.PlanConfig'" class="reference internal" href="#stable_worldmodel.policy.PlanConfig"><code class="docutils literal notranslate"><span class="pre">PlanConfig</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.PlanConfig.action_block'" class="reference internal" href="#stable_worldmodel.policy.PlanConfig.action_block"><code class="docutils literal notranslate"><span class="pre">PlanConfig.action_block</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.PlanConfig.history_len'" class="reference internal" href="#stable_worldmodel.policy.PlanConfig.history_len"><code class="docutils literal notranslate"><span class="pre">PlanConfig.history_len</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.PlanConfig.horizon'" class="reference internal" href="#stable_worldmodel.policy.PlanConfig.horizon"><code class="docutils literal notranslate"><span class="pre">PlanConfig.horizon</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.PlanConfig.plan_len'" class="reference internal" href="#stable_worldmodel.policy.PlanConfig.plan_len"><code class="docutils literal notranslate"><span class="pre">PlanConfig.plan_len</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.PlanConfig.receding_horizon'" class="reference internal" href="#stable_worldmodel.policy.PlanConfig.receding_horizon"><code class="docutils literal notranslate"><span class="pre">PlanConfig.receding_horizon</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.PlanConfig.warm_start'" class="reference internal" href="#stable_worldmodel.policy.PlanConfig.warm_start"><code class="docutils literal notranslate"><span class="pre">PlanConfig.warm_start</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.RandomPolicy'" class="reference internal" href="#stable_worldmodel.policy.RandomPolicy"><code class="docutils literal notranslate"><span class="pre">RandomPolicy</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.RandomPolicy.get_action'" class="reference internal" href="#stable_worldmodel.policy.RandomPolicy.get_action"><code class="docutils literal notranslate"><span class="pre">RandomPolicy.get_action()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.RandomPolicy.set_seed'" class="reference internal" href="#stable_worldmodel.policy.RandomPolicy.set_seed"><code class="docutils literal notranslate"><span class="pre">RandomPolicy.set_seed()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.Transformable'" class="reference internal" href="#stable_worldmodel.policy.Transformable"><code class="docutils literal notranslate"><span class="pre">Transformable</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.Transformable.inverse_transform'" class="reference internal" href="#stable_worldmodel.policy.Transformable.inverse_transform"><code class="docutils literal notranslate"><span class="pre">Transformable.inverse_transform()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.Transformable.transform'" class="reference internal" href="#stable_worldmodel.policy.Transformable.transform"><code class="docutils literal notranslate"><span class="pre">Transformable.transform()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.WorldModelPolicy'" class="reference internal" href="#stable_worldmodel.policy.WorldModelPolicy"><code class="docutils literal notranslate"><span class="pre">WorldModelPolicy</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.WorldModelPolicy.flatten_receding_horizon'" class="reference internal" href="#stable_worldmodel.policy.WorldModelPolicy.flatten_receding_horizon"><code class="docutils literal notranslate"><span class="pre">WorldModelPolicy.flatten_receding_horizon</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.WorldModelPolicy.get_action'" class="reference internal" href="#stable_worldmodel.policy.WorldModelPolicy.get_action"><code class="docutils literal notranslate"><span class="pre">WorldModelPolicy.get_action()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.policy.WorldModelPolicy.set_env'" class="reference internal" href="#stable_worldmodel.policy.WorldModelPolicy.set_env"><code class="docutils literal notranslate"><span class="pre">WorldModelPolicy.set_env()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a :data-current="activeSection === '#module-stable_worldmodel.spaces'" class="reference internal" href="#module-stable_worldmodel.spaces">stable_worldmodel.spaces module</a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Box'" class="reference internal" href="#stable_worldmodel.spaces.Box"><code class="docutils literal notranslate"><span class="pre">Box</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Box.__init__'" class="reference internal" href="#stable_worldmodel.spaces.Box.__init__"><code class="docutils literal notranslate"><span class="pre">Box.__init__()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Box.check'" class="reference internal" href="#stable_worldmodel.spaces.Box.check"><code class="docutils literal notranslate"><span class="pre">Box.check()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Box.contains'" class="reference internal" href="#stable_worldmodel.spaces.Box.contains"><code class="docutils literal notranslate"><span class="pre">Box.contains()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Box.init_value'" class="reference internal" href="#stable_worldmodel.spaces.Box.init_value"><code class="docutils literal notranslate"><span class="pre">Box.init_value</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Box.reset'" class="reference internal" href="#stable_worldmodel.spaces.Box.reset"><code class="docutils literal notranslate"><span class="pre">Box.reset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Box.sample'" class="reference internal" href="#stable_worldmodel.spaces.Box.sample"><code class="docutils literal notranslate"><span class="pre">Box.sample()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Box.value'" class="reference internal" href="#stable_worldmodel.spaces.Box.value"><code class="docutils literal notranslate"><span class="pre">Box.value</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Dict'" class="reference internal" href="#stable_worldmodel.spaces.Dict"><code class="docutils literal notranslate"><span class="pre">Dict</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Dict.__init__'" class="reference internal" href="#stable_worldmodel.spaces.Dict.__init__"><code class="docutils literal notranslate"><span class="pre">Dict.__init__()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Dict.check'" class="reference internal" href="#stable_worldmodel.spaces.Dict.check"><code class="docutils literal notranslate"><span class="pre">Dict.check()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Dict.contains'" class="reference internal" href="#stable_worldmodel.spaces.Dict.contains"><code class="docutils literal notranslate"><span class="pre">Dict.contains()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Dict.init_value'" class="reference internal" href="#stable_worldmodel.spaces.Dict.init_value"><code class="docutils literal notranslate"><span class="pre">Dict.init_value</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Dict.names'" class="reference internal" href="#stable_worldmodel.spaces.Dict.names"><code class="docutils literal notranslate"><span class="pre">Dict.names()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Dict.reset'" class="reference internal" href="#stable_worldmodel.spaces.Dict.reset"><code class="docutils literal notranslate"><span class="pre">Dict.reset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Dict.sample'" class="reference internal" href="#stable_worldmodel.spaces.Dict.sample"><code class="docutils literal notranslate"><span class="pre">Dict.sample()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Dict.sampling_order'" class="reference internal" href="#stable_worldmodel.spaces.Dict.sampling_order"><code class="docutils literal notranslate"><span class="pre">Dict.sampling_order</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Dict.update'" class="reference internal" href="#stable_worldmodel.spaces.Dict.update"><code class="docutils literal notranslate"><span class="pre">Dict.update()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Dict.value'" class="reference internal" href="#stable_worldmodel.spaces.Dict.value"><code class="docutils literal notranslate"><span class="pre">Dict.value</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Discrete'" class="reference internal" href="#stable_worldmodel.spaces.Discrete"><code class="docutils literal notranslate"><span class="pre">Discrete</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Discrete.__init__'" class="reference internal" href="#stable_worldmodel.spaces.Discrete.__init__"><code class="docutils literal notranslate"><span class="pre">Discrete.__init__()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Discrete.check'" class="reference internal" href="#stable_worldmodel.spaces.Discrete.check"><code class="docutils literal notranslate"><span class="pre">Discrete.check()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Discrete.contains'" class="reference internal" href="#stable_worldmodel.spaces.Discrete.contains"><code class="docutils literal notranslate"><span class="pre">Discrete.contains()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Discrete.init_value'" class="reference internal" href="#stable_worldmodel.spaces.Discrete.init_value"><code class="docutils literal notranslate"><span class="pre">Discrete.init_value</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Discrete.reset'" class="reference internal" href="#stable_worldmodel.spaces.Discrete.reset"><code class="docutils literal notranslate"><span class="pre">Discrete.reset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Discrete.sample'" class="reference internal" href="#stable_worldmodel.spaces.Discrete.sample"><code class="docutils literal notranslate"><span class="pre">Discrete.sample()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.Discrete.value'" class="reference internal" href="#stable_worldmodel.spaces.Discrete.value"><code class="docutils literal notranslate"><span class="pre">Discrete.value</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.MultiDiscrete'" class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.MultiDiscrete.__init__'" class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete.__init__"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete.__init__()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.MultiDiscrete.check'" class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete.check"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete.check()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.MultiDiscrete.contains'" class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete.contains"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete.contains()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.MultiDiscrete.init_value'" class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete.init_value"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete.init_value</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.MultiDiscrete.reset'" class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete.reset"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete.reset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.MultiDiscrete.sample'" class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete.sample"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete.sample()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.MultiDiscrete.value'" class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete.value"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete.value</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.spaces.RGBBox'" class="reference internal" href="#stable_worldmodel.spaces.RGBBox"><code class="docutils literal notranslate"><span class="pre">RGBBox</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#module-stable_worldmodel.utils'" class="reference internal" href="#module-stable_worldmodel.utils">stable_worldmodel.utils module</a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.utils.flatten_dict'" class="reference internal" href="#stable_worldmodel.utils.flatten_dict"><code class="docutils literal notranslate"><span class="pre">flatten_dict()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.utils.get_in'" class="reference internal" href="#stable_worldmodel.utils.get_in"><code class="docutils literal notranslate"><span class="pre">get_in()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.utils.pretraining'" class="reference internal" href="#stable_worldmodel.utils.pretraining"><code class="docutils literal notranslate"><span class="pre">pretraining()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#module-stable_worldmodel.world'" class="reference internal" href="#module-stable_worldmodel.world">stable_worldmodel.world module</a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World'" class="reference internal" href="#stable_worldmodel.world.World"><code class="docutils literal notranslate"><span class="pre">World</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.__init__'" class="reference internal" href="#stable_worldmodel.world.World.__init__"><code class="docutils literal notranslate"><span class="pre">World.__init__()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.action_space'" class="reference internal" href="#stable_worldmodel.world.World.action_space"><code class="docutils literal notranslate"><span class="pre">World.action_space</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.close'" class="reference internal" href="#stable_worldmodel.world.World.close"><code class="docutils literal notranslate"><span class="pre">World.close()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.evaluate'" class="reference internal" href="#stable_worldmodel.world.World.evaluate"><code class="docutils literal notranslate"><span class="pre">World.evaluate()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.num_envs'" class="reference internal" href="#stable_worldmodel.world.World.num_envs"><code class="docutils literal notranslate"><span class="pre">World.num_envs</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.observation_space'" class="reference internal" href="#stable_worldmodel.world.World.observation_space"><code class="docutils literal notranslate"><span class="pre">World.observation_space</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.record_dataset'" class="reference internal" href="#stable_worldmodel.world.World.record_dataset"><code class="docutils literal notranslate"><span class="pre">World.record_dataset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.record_video'" class="reference internal" href="#stable_worldmodel.world.World.record_video"><code class="docutils literal notranslate"><span class="pre">World.record_video()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.record_video_from_dataset'" class="reference internal" href="#stable_worldmodel.world.World.record_video_from_dataset"><code class="docutils literal notranslate"><span class="pre">World.record_video_from_dataset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.reset'" class="reference internal" href="#stable_worldmodel.world.World.reset"><code class="docutils literal notranslate"><span class="pre">World.reset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.set_policy'" class="reference internal" href="#stable_worldmodel.world.World.set_policy"><code class="docutils literal notranslate"><span class="pre">World.set_policy()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.single_action_space'" class="reference internal" href="#stable_worldmodel.world.World.single_action_space"><code class="docutils literal notranslate"><span class="pre">World.single_action_space</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.single_observation_space'" class="reference internal" href="#stable_worldmodel.world.World.single_observation_space"><code class="docutils literal notranslate"><span class="pre">World.single_observation_space</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.single_variation_space'" class="reference internal" href="#stable_worldmodel.world.World.single_variation_space"><code class="docutils literal notranslate"><span class="pre">World.single_variation_space</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.step'" class="reference internal" href="#stable_worldmodel.world.World.step"><code class="docutils literal notranslate"><span class="pre">World.step()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.world.World.variation_space'" class="reference internal" href="#stable_worldmodel.world.World.variation_space"><code class="docutils literal notranslate"><span class="pre">World.variation_space</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a :data-current="activeSection === '#module-stable_worldmodel.wrappers'" class="reference internal" href="#module-stable_worldmodel.wrappers">stable_worldmodel.wrappers module</a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.AddPixelsWrapper'" class="reference internal" href="#stable_worldmodel.wrappers.AddPixelsWrapper"><code class="docutils literal notranslate"><span class="pre">AddPixelsWrapper</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.AddPixelsWrapper.reset'" class="reference internal" href="#stable_worldmodel.wrappers.AddPixelsWrapper.reset"><code class="docutils literal notranslate"><span class="pre">AddPixelsWrapper.reset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.AddPixelsWrapper.step'" class="reference internal" href="#stable_worldmodel.wrappers.AddPixelsWrapper.step"><code class="docutils literal notranslate"><span class="pre">AddPixelsWrapper.step()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.EnsureGoalInfoWrapper'" class="reference internal" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper"><code class="docutils literal notranslate"><span class="pre">EnsureGoalInfoWrapper</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.reset'" class="reference internal" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.reset"><code class="docutils literal notranslate"><span class="pre">EnsureGoalInfoWrapper.reset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.step'" class="reference internal" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.step"><code class="docutils literal notranslate"><span class="pre">EnsureGoalInfoWrapper.step()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.EnsureImageShape'" class="reference internal" href="#stable_worldmodel.wrappers.EnsureImageShape"><code class="docutils literal notranslate"><span class="pre">EnsureImageShape</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.EnsureImageShape.reset'" class="reference internal" href="#stable_worldmodel.wrappers.EnsureImageShape.reset"><code class="docutils literal notranslate"><span class="pre">EnsureImageShape.reset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.EnsureImageShape.step'" class="reference internal" href="#stable_worldmodel.wrappers.EnsureImageShape.step"><code class="docutils literal notranslate"><span class="pre">EnsureImageShape.step()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.EnsureInfoKeysWrapper'" class="reference internal" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper"><code class="docutils literal notranslate"><span class="pre">EnsureInfoKeysWrapper</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.reset'" class="reference internal" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.reset"><code class="docutils literal notranslate"><span class="pre">EnsureInfoKeysWrapper.reset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.step'" class="reference internal" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.step"><code class="docutils literal notranslate"><span class="pre">EnsureInfoKeysWrapper.step()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.EverythingToInfoWrapper'" class="reference internal" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper"><code class="docutils literal notranslate"><span class="pre">EverythingToInfoWrapper</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.EverythingToInfoWrapper.reset'" class="reference internal" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper.reset"><code class="docutils literal notranslate"><span class="pre">EverythingToInfoWrapper.reset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.EverythingToInfoWrapper.step'" class="reference internal" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper.step"><code class="docutils literal notranslate"><span class="pre">EverythingToInfoWrapper.step()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.MegaWrapper'" class="reference internal" href="#stable_worldmodel.wrappers.MegaWrapper"><code class="docutils literal notranslate"><span class="pre">MegaWrapper</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.MegaWrapper.reset'" class="reference internal" href="#stable_worldmodel.wrappers.MegaWrapper.reset"><code class="docutils literal notranslate"><span class="pre">MegaWrapper.reset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.MegaWrapper.step'" class="reference internal" href="#stable_worldmodel.wrappers.MegaWrapper.step"><code class="docutils literal notranslate"><span class="pre">MegaWrapper.step()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.ResizeGoalWrapper'" class="reference internal" href="#stable_worldmodel.wrappers.ResizeGoalWrapper"><code class="docutils literal notranslate"><span class="pre">ResizeGoalWrapper</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.ResizeGoalWrapper.reset'" class="reference internal" href="#stable_worldmodel.wrappers.ResizeGoalWrapper.reset"><code class="docutils literal notranslate"><span class="pre">ResizeGoalWrapper.reset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.ResizeGoalWrapper.step'" class="reference internal" href="#stable_worldmodel.wrappers.ResizeGoalWrapper.step"><code class="docutils literal notranslate"><span class="pre">ResizeGoalWrapper.step()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.VariationWrapper'" class="reference internal" href="#stable_worldmodel.wrappers.VariationWrapper"><code class="docutils literal notranslate"><span class="pre">VariationWrapper</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.wrappers.VariationWrapper.envs'" class="reference internal" href="#stable_worldmodel.wrappers.VariationWrapper.envs"><code class="docutils literal notranslate"><span class="pre">VariationWrapper.envs</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a :data-current="activeSection === '#module-stable_worldmodel'" class="reference internal" href="#module-stable_worldmodel">Module contents</a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.PlanConfig'" class="reference internal" href="#stable_worldmodel.PlanConfig"><code class="docutils literal notranslate"><span class="pre">PlanConfig</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.PlanConfig.action_block'" class="reference internal" href="#stable_worldmodel.PlanConfig.action_block"><code class="docutils literal notranslate"><span class="pre">PlanConfig.action_block</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.PlanConfig.history_len'" class="reference internal" href="#stable_worldmodel.PlanConfig.history_len"><code class="docutils literal notranslate"><span class="pre">PlanConfig.history_len</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.PlanConfig.horizon'" class="reference internal" href="#stable_worldmodel.PlanConfig.horizon"><code class="docutils literal notranslate"><span class="pre">PlanConfig.horizon</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.PlanConfig.plan_len'" class="reference internal" href="#stable_worldmodel.PlanConfig.plan_len"><code class="docutils literal notranslate"><span class="pre">PlanConfig.plan_len</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.PlanConfig.receding_horizon'" class="reference internal" href="#stable_worldmodel.PlanConfig.receding_horizon"><code class="docutils literal notranslate"><span class="pre">PlanConfig.receding_horizon</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.PlanConfig.warm_start'" class="reference internal" href="#stable_worldmodel.PlanConfig.warm_start"><code class="docutils literal notranslate"><span class="pre">PlanConfig.warm_start</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.World'" class="reference internal" href="#stable_worldmodel.World"><code class="docutils literal notranslate"><span class="pre">World</span></code></a><ul>
<li><a :data-current="activeSection === '#stable_worldmodel.World.__init__'" class="reference internal" href="#stable_worldmodel.World.__init__"><code class="docutils literal notranslate"><span class="pre">World.__init__()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.action_space'" class="reference internal" href="#stable_worldmodel.World.action_space"><code class="docutils literal notranslate"><span class="pre">World.action_space</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.close'" class="reference internal" href="#stable_worldmodel.World.close"><code class="docutils literal notranslate"><span class="pre">World.close()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.evaluate'" class="reference internal" href="#stable_worldmodel.World.evaluate"><code class="docutils literal notranslate"><span class="pre">World.evaluate()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.num_envs'" class="reference internal" href="#stable_worldmodel.World.num_envs"><code class="docutils literal notranslate"><span class="pre">World.num_envs</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.observation_space'" class="reference internal" href="#stable_worldmodel.World.observation_space"><code class="docutils literal notranslate"><span class="pre">World.observation_space</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.record_dataset'" class="reference internal" href="#stable_worldmodel.World.record_dataset"><code class="docutils literal notranslate"><span class="pre">World.record_dataset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.record_video'" class="reference internal" href="#stable_worldmodel.World.record_video"><code class="docutils literal notranslate"><span class="pre">World.record_video()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.record_video_from_dataset'" class="reference internal" href="#stable_worldmodel.World.record_video_from_dataset"><code class="docutils literal notranslate"><span class="pre">World.record_video_from_dataset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.reset'" class="reference internal" href="#stable_worldmodel.World.reset"><code class="docutils literal notranslate"><span class="pre">World.reset()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.set_policy'" class="reference internal" href="#stable_worldmodel.World.set_policy"><code class="docutils literal notranslate"><span class="pre">World.set_policy()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.single_action_space'" class="reference internal" href="#stable_worldmodel.World.single_action_space"><code class="docutils literal notranslate"><span class="pre">World.single_action_space</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.single_observation_space'" class="reference internal" href="#stable_worldmodel.World.single_observation_space"><code class="docutils literal notranslate"><span class="pre">World.single_observation_space</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.single_variation_space'" class="reference internal" href="#stable_worldmodel.World.single_variation_space"><code class="docutils literal notranslate"><span class="pre">World.single_variation_space</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.step'" class="reference internal" href="#stable_worldmodel.World.step"><code class="docutils literal notranslate"><span class="pre">World.step()</span></code></a></li>
<li><a :data-current="activeSection === '#stable_worldmodel.World.variation_space'" class="reference internal" href="#stable_worldmodel.World.variation_space"><code class="docutils literal notranslate"><span class="pre">World.variation_space</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#stable_worldmodel.pretraining'" class="reference internal" href="#stable_worldmodel.pretraining"><code class="docutils literal notranslate"><span class="pre">pretraining()</span></code></a></li>
</ul>
</li>
</ul>
</div>
</aside>
</main>
</div>
</div><footer class="py-6 border-t border-border md:py-0">
<div class="container flex flex-col items-center justify-between gap-4 md:h-24 md:flex-row">
<div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0">
<p class="text-sm leading-loose text-center text-muted-foreground md:text-left">Â© 2025Â Built with <a class="font-medium underline underline-offset-4" href="https://www.sphinx-doc.org" rel="noreferrer">Sphinx 8.2.3</a></p>
</div>
</div>
</footer>
</div><button :class="{'opacity-0 invisible' : !showScrollTop}" @click="window.scrollTo({top: 0, behavior: 'smooth'})" class="fixed bottom-8 right-8 p-2 z-10 rounded-sm bg-gray-700 text-xs text-white transition-all duration-1000 hover:bg-gray-950 focus:bg-gray-950" id="scrolltop" x-cloak="">
<svg aria-hidden="true" class="inline fill-current mb-[2px]" height="14" viewbox="0 96 960 960" width="14" xmlns="http://www.w3.org/2000/svg">
<path d="M450 896V370L202 618l-42-42 320-320 320 320-42 42-248-248v526h-60Z"></path>
</svg>
  Back to top
</button>
<script src="../_static/documentation_options.js?v=2c52d5bf"></script>
<script src="../_static/doctools.js?v=9bcbadda"></script>
<script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
<script defer="defer" src="../_static/theme.js?v=073f68d9"></script>
<script src="../_static/design-tabs.js?v=f930bc37"></script>
</body>
</html>